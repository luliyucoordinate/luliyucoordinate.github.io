<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 3 页 | coordinate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
    <meta name="google-site-verification" content="true" />
  
  
    <meta name="baidu-site-verification" content="true" />
  
  
    <meta name="360-site-verification" content="true" />
  
  <meta property="og:type" content="website">
<meta property="og:title" content="coordinate">
<meta property="og:url" content="http://coordinate.wang/page/3/index.html">
<meta property="og:site_name" content="coordinate">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="coordinate">
  
    <link rel="alternate" href="/atom.xml" title="coordinate" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body>


  
  
  <div class="site-header-image">
    <img id="originBg" width="100%" alt="Hike News" src="">
  </div>

  <div id="header-blur" class="site-header-image blur" style="position: absolute; top:0; height: 207px; min-height: 207px; min-width: 100%;">
    <img id="blurBg" width="100%" style="top: 96%" alt="Hike News" src="">
  </div>

  <script>
        var imgUrls = "css/images/pose01.jpg,css/images/pose02.jpg,css/images/pose03.jpg".split(",");
        var random = Math.floor((Math.random() * imgUrls.length ));
        if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
          document.getElementById("originBg").src=imgUrls[random];
          document.getElementById("blurBg").src=imgUrls[random];
        } else {
          document.getElementById("originBg").src='/' + imgUrls[random];
          document.getElementById("blurBg").src='/' + imgUrls[random];
        }
    </script>




<header id="allheader" class="site-header" role="banner" 
   style="width: 100%; position: absolute; top:0; background: rgba(255,255,255,.8);"  >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="coordinate" rel="home"> coordinate </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-2017-11-9-numpy.array-的创建"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/09/2017-11-9-numpy.array-的创建/">numpy.array 的创建</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/09/2017-11-9-numpy.array-的创建/" class="article-date">
	  <time datetime="2017-11-08T16:00:00.000Z" itemprop="datePublished">十一月 9, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/python/">python</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>通过array将数据（列表、元祖、数组等序列类型）转化为numpy array</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.1</span>)</span><br><span class="line">data2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.1</span>]</span><br><span class="line">arr = np.array(data)</span><br><span class="line">arr2 = np.array(data2)</span><br></pre></td></tr></table></figure>
<p>通过zeros创建全为0的numpy array</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.zeros(<span class="number">3</span>) <span class="comment"># 生成包含3个0的一维数组</span></span><br><span class="line">np.zeros((<span class="number">3</span>, <span class="number">3</span>)) <span class="comment"># 生成3*3的二维数组</span></span><br></pre></td></tr></table></figure>
<p>通过ones创建全为1的numpy array</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.ones(<span class="number">3</span>) <span class="comment"># 生成包含3个1的一维数组</span></span><br><span class="line">np.ones((<span class="number">3</span>, <span class="number">3</span>)) <span class="comment"># 生成3*3的二维数组</span></span><br></pre></td></tr></table></figure>
<p>通过empty创建numpy array，只分配空间，数据随机</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> np.empty((<span class="number">3</span>, <span class="number">3</span>)) <span class="comment"># 生成3*3的二维数组，所有元素未初始化。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[  9.90943830e-290   1.16310967e+214   5.56206154e+180]</span><br><span class="line"> [  4.83245960e+276   8.03704345e-095   5.50495710e-095]</span><br><span class="line"> [  1.69281515e+165   6.32263054e+233   7.07116662e-308]]</span><br></pre></td></tr></table></figure>
<p>类似于range那样，可以通过arange创建numpy array</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">9</span>)  <span class="comment"># [0, 1, 2, ..., 9]</span></span><br></pre></td></tr></table></figure>
<p>通过eye或identity创建nxn的单位矩阵</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.eye(<span class="number">4</span>) <span class="comment">#生成4*4的单位矩阵</span></span><br><span class="line">np.identity(<span class="number">4</span>) <span class="comment">#生成4*4的单位矩阵</span></span><br></pre></td></tr></table></figure>
<p>asarray是将数据（列表、元祖、数组等序列类型）转化为numpy array，如果数据是numpy array类型的话就不复制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr1=np.ones((<span class="number">3</span>,<span class="number">3</span>))  </span><br><span class="line">arr2=np.array(arr1)  </span><br><span class="line">arr3=np.asarray(arr1) <span class="comment">#相当于arr1和arr3指向同一块内存</span></span><br><span class="line">arr1[<span class="number">1</span>]=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">arr1:  </span><br><span class="line">[[ 1.  1.  1.]  </span><br><span class="line"> [ 2.  2.  2.]  </span><br><span class="line"> [ 1.  1.  1.]]  </span><br><span class="line">arr2:  </span><br><span class="line">[[ 1.  1.  1.]  </span><br><span class="line"> [ 1.  1.  1.]  </span><br><span class="line"> [ 1.  1.  1.]]  </span><br><span class="line">arr3:  </span><br><span class="line">[[ 1.  1.  1.]  </span><br><span class="line"> [ 2.  2.  2.]  </span><br><span class="line"> [ 1.  1.  1.]]</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/python/">python</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/numpy/">numpy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-8-numpy.array-和-array以及list的效率对比"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/08/2017-11-8-numpy.array-和-array以及list的效率对比/">numpy.array 和 array以及list的效率对比</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/08/2017-11-8-numpy.array-和-array以及list的效率对比/" class="article-date">
	  <time datetime="2017-11-07T16:00:00.000Z" itemprop="datePublished">十一月 8, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/python/">python</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line">common_for = <span class="string">"""</span></span><br><span class="line"><span class="string">for d in data:</span></span><br><span class="line"><span class="string">    s += d</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">common_sum = <span class="string">"""</span></span><br><span class="line"><span class="string">sum(data)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">common_numpy_sum = <span class="string">"""</span></span><br><span class="line"><span class="string">numpy.sum(data)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeit_list</span><span class="params">(n, loops)</span>:</span></span><br><span class="line">    list_setup = <span class="string">"""</span></span><br><span class="line"><span class="string">import numpy</span></span><br><span class="line"><span class="string">data = [1] * &#123;0&#125;#生成n个数的列表</span></span><br><span class="line"><span class="string">s = 0</span></span><br><span class="line"><span class="string">"""</span>.format(n)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'list:'</span></span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_for, list_setup, number = loops)<span class="comment">#'common_for'是要执行语句 list_setup导入执行语句需要的数据，loops表示执行语句最后要执行的次数</span></span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_sum, list_setup, number = loops)</span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_numpy_sum, list_setup, number = loops)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeit_array</span><span class="params">(n, loops)</span>:</span></span><br><span class="line">    array_setup = <span class="string">"""</span></span><br><span class="line"><span class="string">import numpy</span></span><br><span class="line"><span class="string">import array</span></span><br><span class="line"><span class="string">data = array.array('L', [1] * &#123;0&#125;)#unsigned long，这里的初始化必须先给类型</span></span><br><span class="line"><span class="string">s = 0</span></span><br><span class="line"><span class="string">"""</span>.format(n)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'array:'</span></span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_for, array_setup, number = loops)</span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_sum, array_setup, number = loops)</span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_numpy_sum, array_setup, number = loops)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeit_numpy</span><span class="params">(n, loops)</span>:</span></span><br><span class="line">    numpy_setup = <span class="string">"""</span></span><br><span class="line"><span class="string">import numpy</span></span><br><span class="line"><span class="string">data = numpy.array([1] * &#123;0&#125;)</span></span><br><span class="line"><span class="string">s = 0</span></span><br><span class="line"><span class="string">"""</span>.format(n)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'numpy:'</span></span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_for, numpy_setup, number = loops)</span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_sum, numpy_setup, number = loops)</span><br><span class="line">    <span class="keyword">print</span> timeit.timeit(common_numpy_sum, numpy_setup, number = loops)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    timeit_list(<span class="number">50000</span>, <span class="number">500</span>)</span><br><span class="line">    timeit_array(<span class="number">50000</span>, <span class="number">500</span>)</span><br><span class="line">    timeit_numpy(<span class="number">50000</span>, <span class="number">500</span>)</span><br></pre></td></tr></table></figure>
<p>我这里的结果是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">list:</span><br><span class="line"><span class="number">0.743401847752</span></span><br><span class="line"><span class="number">0.244681626678</span></span><br><span class="line"><span class="number">1.00076942461</span></span><br><span class="line">array:</span><br><span class="line"><span class="number">1.83873936113</span></span><br><span class="line"><span class="number">1.36051825384</span></span><br><span class="line"><span class="number">4.02721759923</span></span><br><span class="line">numpy:</span><br><span class="line"><span class="number">3.86211620789</span></span><br><span class="line"><span class="number">3.34397739435</span></span><br><span class="line"><span class="number">0.0103776763518</span></span><br></pre></td></tr></table></figure>
<p>所以对于numpy，我们尽量使用它的内置函数吧！</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/python/">python</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/numpy/">numpy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-7-静态绑定和动态绑定总结"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/07/2017-11-7-静态绑定和动态绑定总结/">静态绑定和动态绑定总结</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/07/2017-11-7-静态绑定和动态绑定总结/" class="article-date">
	  <time datetime="2017-11-06T16:00:00.000Z" itemprop="datePublished">十一月 7, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fl7a7htnodj20su0d1wfw.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fl7a7htnodj20su0d1wfw.jpg" class="img-fluid"><br></a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/binding/">binding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-6-虚函数表到底是怎么存放的"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/06/2017-11-6-虚函数表到底是怎么存放的/">虚函数表到底是怎么存放的</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/06/2017-11-6-虚函数表到底是怎么存放的/" class="article-date">
	  <time datetime="2017-11-05T16:00:00.000Z" itemprop="datePublished">十一月 6, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><p>“when VTABLE is get created in Memory , In compiletime or runtime?”</p>
<p>Compile time. The vtable is simple an array of function pointers that gets stored in the executable. It never changes and this array is shared by all instances of a given class. Each instance of a class that has virtual methods contains one vtable pointer (for single inheritance), usually stored at offset 0, before all data members. This pointer is initialized at construction time to point to the vtable for that class.</p>
</li>
</ul>
<p>“当VTABLE被创建在内存中，在编译时或运行时？“</p>
<p>编译时。 vtable是一个简单的函数指针数组，存储在可执行文件中。 它永远不会改变，并且这个数组被给定类的所有实例共享。 具有虚拟方法的类的每个实例都包含一个vtable指针（用于单个继承），通常存储在所有数据成员之前的偏移量0处。 这个指针在构造时被初始化，指向该类的虚表。</p>
<ul>
<li><p>“If the class contain one virtual function , then what is the size of class?”</p>
<p>The class has the same size if it has 1 or 100 virtual functions, size of the class data members + size of the vtable pointer (4 bytes for x86, 8 bytes for x64) (for single inheritance).</p>
</li>
</ul>
<p>“如果这个类包含一个虚拟函数，那么类的大小是多少？”</p>
<p>如果具有1或100个虚拟函数，类数据成员的大小+ vtable指针的大小（x86为4个字节，x64为8个字节）（单个继承），则该类具有相同的大小。</p>
<ul>
<li><p>“Heap or Stack?”</p>
<p>As I said, the vtable is stored in the executable. The executable is memory mapped so basically it’s stored in the same place where the code is, in memory that belongs to a memory mapped section, that’s neither heap nor stack.</p>
</li>
</ul>
<p>“堆或堆？”</p>
<p>正如我所说的，vtable存储在可执行文件中。 可执行程序是内存映射的，所以基本上它存储在代码所在的同一个地方，属于内存映射部分的内存中，既不堆也不堆栈。</p>
<ul>
<li>And one more thing initialization of v-table  take place under default constructor.The vtable is built at compile time( statically allocated).Each of the type instances contains a pointer to this table Because this pointer is initialized at construction time, a virtual member function should never be called from the constructor</li>
</ul>
<p>还有一件事是在默认的构造函数下进行v-table的初始化。vtable是在编译时建立的（静态分配的）。每个类型实例都包含一个指向这个表的指针因为这个指针在构造时被初始化， 一个虚成员函数不应该被构造函数调用。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vfptr/">vfptr</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-5-纯虚函数调用"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/05/2017-11-5-纯虚函数调用/">纯虚函数的调用</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/05/2017-11-5-纯虚函数调用/" class="article-date">
	  <time datetime="2017-11-04T16:00:00.000Z" itemprop="datePublished">十一月 5, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>看到这个标题的时候你可能会惊讶？纯虚函数怎么可以调用呢？看下面这个例子</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Abstract_base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">virtual</span> ~Abstract_base();</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">interface</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">mumble</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> _mumble; &#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="keyword">char</span> *_mumble;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Concrete_derived</span> :</span><span class="keyword">public</span> Abstract_base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Concrete_deriverd</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">interface</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> Abstract_base::interface()</span><br><span class="line">&#123;</span><br><span class="line">    function</span><br><span class="line">      <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> Concrete_derived::interface()</span><br><span class="line">&#123;</span><br><span class="line">    Abstract_base::interface();<span class="comment">//静态调用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不过只可以通过静态调用，不可以通过虚拟机制去调用。为什么不可以？如果这样做</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Concrete_derived *p = <span class="keyword">new</span> Abstract_base;<span class="comment">//错误，Abstract_Base是一个抽象数据类，不允许构造一个对象</span></span><br><span class="line">p-&gt;interface();</span><br></pre></td></tr></table></figure>
<p>你似乎会觉得这没什么！那我接着加大难度</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Base()&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">callFunc</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~Base()&#123;&#125;;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Func</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span><span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Derived()&#123;&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Func</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">void</span> Base::Func()</span><br><span class="line">&#123;</span><br><span class="line">  	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"func in Base!"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Base::callFunc()</span><br><span class="line">&#123;</span><br><span class="line">  	Func();</span><br><span class="line">  	Base::Func();<span class="comment">//静态调用纯虚函数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Derived::Func()</span><br><span class="line">&#123;</span><br><span class="line">  	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"func in Derived!"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Base *pd = <span class="keyword">new</span> Derived;</span><br><span class="line">	pd-&gt;callFunc();</span><br><span class="line">	<span class="keyword">delete</span> pd;</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果是</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func in Derived!</span><br><span class="line">func in Base!</span><br></pre></td></tr></table></figure>
<p>你这个时候是不是很困惑？<code>Base</code>中的<code>callFunc</code>函数分别调用了在<code>Base</code>中定义的纯虚函数版本和<code>Derived</code>中的实现版本。为什么？<code>Base</code>中的<code>callFunc</code>函数调用了<code>Derived</code>中的<strong>私有虚函数</strong>！它竟然绕过了访问控制机制！为什么？</p>
<p>我们慢慢开始，首先我们知道这里<code>pd</code>没有发生动态绑定，因为调用的不是虚函数，这里我们可以明确<code>pd</code>调用的是<code>Base::callFunc()</code>接着进入<code>Base::callFunc()</code>内部。第一个函数<code>Func()</code>，这里我们会疑惑，到底是<code>Base::Func()</code>还是<code>Derived::Func()</code>？这时你可能很快地回答我<code>Base::Func()</code>。因为我在 <a href="http://blog.csdn.net/qq_17550379/article/details/78436845" target="_blank" rel="noopener">关于重载、隐藏、重写的一些思考（1）</a> 中谈过类继承里面的作用域问题。此时你坚信这是在<code>Base</code>的作用域里面，难道调用的不是<code>Base::Func()</code>？<strong>pd确实是在<code>Base</code>的作用域内，但是pd指向的<code>Func</code>是在<code>Derived</code> 的作用域内的</strong>。我在  <a href="http://blog.csdn.net/qq_17550379/article/details/78436873" target="_blank" rel="noopener">关于重载、隐藏、重写的一些思考（2）</a>中分析了复杂作用域的问题。</p>
<p>我这里提出这样一个问题，如果<code>Derived</code>内也有一个<code>callFunc</code>函数，那么此时pd调用的还是<code>Base::callFunc()</code>吗？我这里给出答案，是的，因为pd是在<code>Base</code>的作用域内。</p>
<p>从另一个角度看这个问题，<code>Func</code>是一个虚函数，它会是一种动态绑定。也就是说这里的<code>Func</code> 是根据运行期来决定的。这个时候<code>pd</code>实际上是一个<code>Derived</code>类型的首地址（Derived虚函数表的地址），自然地会找到<code>Derived::Func()</code>，再次强调这个过程是<strong>动态调用</strong>，接着我们使用<strong>静态调用</strong>去访问<code>Base::Func()</code>。</p>
<p>ok，问题解决了一大半。为什么可以调用<code>Derived</code>的私有函数这里也很好理解了。因为这个函数是在虚函数表里面的，而虚函数表中没有私有这个概念，自然就可以了。</p>
<p>用一张图总结</p>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fl6brmv6hlj20m809i3yq.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fl6brmv6hlj20m809i3yq.jpg" class="img-fluid"><br></a></p>
<p>好的，接着我们会想为什么会有这么奇怪的做法呢？这其实是一种<strong><code>Template Method</code>设计模式</strong>。</p>
<p>另外还有一个问题，细心的同学会发现，第一个例子是一个抽象类，但是它里面有一个保护成员<code>char *_mumble</code> ，问什么会有这样的做法？我们该怎么初始化这个数据？请看<a href="http://blog.csdn.net/qq_17550379/article/details/78441420" target="_blank" rel="noopener">抽象类中的数据</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-4-关于重载、隐藏、重写的一些思考（2）"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/04/2017-11-4-关于重载、隐藏、重写的一些思考（2）/">关于重载、隐藏、重写的一些思考（2）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/04/2017-11-4-关于重载、隐藏、重写的一些思考（2）/" class="article-date">
	  <time datetime="2017-11-03T16:00:00.000Z" itemprop="datePublished">十一月 4, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://blog.csdn.net/qq_17550379/article/details/78436845" target="_blank" rel="noopener">关于重载、隐藏、重写的一些思考（1）</a>内容我们谈到了override，我说它和namehiding看上去很相似。我们先验证一下，它是否有namehiding的一些特征，并且又有哪些不同。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="comment">//重载</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span>)</span></span>;			<span class="comment">//重载</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;		<span class="comment">//override</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func4</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Derived d;</span><br><span class="line">d.func1();		<span class="comment">//调用Derived::func1()</span></span><br><span class="line">d.func2();		<span class="comment">//调用Derived::func2()重写了Base::func2() 隐藏了Base::func2(int)</span></span><br><span class="line">d.func2(<span class="number">3</span>);		<span class="comment">//错误，无法调用Base::func2(int)</span></span><br><span class="line">d.func3();		<span class="comment">//调用Derived::func3()隐藏了Base::func3()和Base::func3(int)</span></span><br><span class="line">d.func3(<span class="number">3</span>);		<span class="comment">//错误，无法调用Base::func3(int)</span></span><br></pre></td></tr></table></figure>
<p>override和namehiding发生了同样的事情。好，很不错。</p>
<p>既然我们把一个东西藏起来了，那么我们也有办法把他找到。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="comment">//重载</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span>)</span></span>;			<span class="comment">//重载</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">using</span> Base::func3;			<span class="comment">//新加入</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;		</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func4</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.func3();		<span class="comment">//调用Base::func3()</span></span><br></pre></td></tr></table></figure>
<p>嗯，我们似乎做的不错，我们也可以这样去调用<code>Base::func3()</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.Base::func3();	<span class="comment">//调用Base::func3()</span></span><br></pre></td></tr></table></figure>
<p>这些都恰恰说明了，隐藏仅仅是隐藏，它原来的东西还是有的，并没有消失。接着我们再看看发生override的<code>func2</code> ，当我们这样去做的时候</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.Base::func2();	 <span class="comment">//调用Base::func2()&lt;--------------</span></span><br><span class="line">d.Base::func2(<span class="number">3</span>);	 <span class="comment">//调用Base::func2(int)&lt;-----------</span></span><br></pre></td></tr></table></figure>
<p>ok，我们很愉快的看到了override和namehiding在这一点上又有了相似的特性。</p>
<p>我们再通过之前的一个<a href="http://blog.csdn.net/qq_17550379/article/details/78097310" target="_blank" rel="noopener">小技巧</a>，查看类的结构。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">1&gt;  class Base	size(4):</span><br><span class="line">1&gt;  	+---</span><br><span class="line">1&gt;   0	| &#123;vfptr&#125;</span><br><span class="line">1&gt;  	+---</span><br><span class="line">1&gt;</span><br><span class="line">1&gt;  Base::$vftable@:</span><br><span class="line">1&gt;  	| &amp;Base_meta</span><br><span class="line">1&gt;  	|  0</span><br><span class="line">1&gt;   0	| &amp;Base::func1</span><br><span class="line">1&gt;   1	| &amp;Base::func2</span><br><span class="line">1&gt;   2	| &amp;Base::func2</span><br><span class="line">1&gt;</span><br><span class="line">1&gt;  Base::func1 this adjustor: 0</span><br><span class="line">1&gt;  Base::func2 this adjustor: 0</span><br><span class="line">1&gt;  Base::func2 this adjustor: 0</span><br><span class="line">1&gt;</span><br><span class="line">1&gt;  class Derived	size(4):</span><br><span class="line">1&gt;  	+---</span><br><span class="line">1&gt;   0	| +--- (base class Base)</span><br><span class="line">1&gt;   0	| | &#123;vfptr&#125;</span><br><span class="line">1&gt;  	| +---</span><br><span class="line">1&gt;  	+---</span><br><span class="line">1&gt;</span><br><span class="line">1&gt;  Derived::$vftable@:</span><br><span class="line">1&gt;  	| &amp;Derived_meta</span><br><span class="line">1&gt;  	|  0</span><br><span class="line">1&gt;   0	| &amp;Derived::func1</span><br><span class="line">1&gt;   1	| &amp;Base::func2</span><br><span class="line">1&gt;   2	| &amp;Derived::func2</span><br><span class="line">1&gt;</span><br><span class="line">1&gt;  Derived::func1 this adjustor: 0</span><br><span class="line">1&gt;  Derived::func2 this adjustor: 0</span><br></pre></td></tr></table></figure>
<p>Derived虚函数表继承了Base虚函数表里面的所有函数，但是又对之前说的override的函数都进行自己的本地化，都变成了Derived自己的函数，这个过程是一种<strong>改写</strong>的过程。</p>
<p>很多奇怪的问题就不难理解了。诸如上面的</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.func2();		<span class="comment">//调用Derived::func2()重写了Base::func2() 隐藏了Base::func2(int)</span></span><br></pre></td></tr></table></figure>
<p>为什么会出现这种情况？</p>
<p>我觉得是这样的，首先我们建立了一个<code>Derived</code>类，建立之前会调用基类的构造函数，这个时候会在静态存储区（请看这篇<a href="http://blog.csdn.net/qq_17550379/article/details/78444081" target="_blank" rel="noopener">虚函数表到底是怎么存放的</a>）建立一个属于<code>Base</code>类的vtable，接着构造<code>Derived</code>类的时候又建立了一个属于<code>Derived</code>类的vtable（注意这些vtable都不是属于单一对象的（是公有的），但是vfptr是每个对象都独有的），copy了<code>Base</code>类的vtable里面的所有指向虚函数的指针，并且对<code>Base</code>类vtable里面的指向相同函数名相同参数列表函数的指针进行了本地化（改写）。如下图</p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1fl85n9oxzrj20q00c274j.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1fl85n9oxzrj20q00c274j.jpg" class="img-fluid"><br></a></p>
<p>最后通过汇编去看整个操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Derived d;</span><br><span class="line">01335C08  lea         ecx,[d]  </span><br><span class="line">01335C0B  call        Derived::Derived (013312E4h)  </span><br><span class="line">	int x = 10;</span><br><span class="line">01335C10  mov         dword ptr [x],0Ah  </span><br><span class="line">	d.func1();		//调用Derived::func1()</span><br><span class="line">01335C17  lea         ecx,[d]  </span><br><span class="line">01335C1A  call        Derived::func1 (013314C4h)  </span><br><span class="line">	d.func2();		//调用Derived::func2()</span><br><span class="line">01335C1F  lea         ecx,[d]  </span><br><span class="line">01335C22  call        Derived::func2 (013314C9h)  </span><br><span class="line">	d.func3();		//调用Derived::func3()</span><br><span class="line">01335C27  lea         ecx,[d]  </span><br><span class="line">01335C2A  call        Derived::func3 (013314E2h)  </span><br><span class="line">	d.Base::func3();	//调用Base::func3()&lt;--------------</span><br><span class="line">01335C2F  lea         ecx,[d]  </span><br><span class="line">01335C32  call        Base::func3 (013314D8h)  </span><br><span class="line">	d.Base::func2();	//调用Base::func2()&lt;--------------</span><br><span class="line">01335C37  lea         ecx,[d]  </span><br><span class="line">01335C3A  call        Base::func2 (013314D3h)  </span><br><span class="line">	d.Base::func2(3);	//调用Base::func2(int)&lt;-----------</span><br><span class="line">01335C3F  push        3  </span><br><span class="line">01335C41  lea         ecx,[d]  </span><br><span class="line">01335C44  call        Base::func2 (013314CEh)</span><br></pre></td></tr></table></figure>
<p>我们通过上述的列子可以看到，在<strong>静态绑定</strong>的情况下，namehiding和override表现出了一样的性质。</p>
<p>那到底哪不同呢？它们的不同出现在<strong>动态绑定</strong>时（我总结过什么时候会发生<a href="http://blog.csdn.net/qq_17550379/article/details/78450245" target="_blank" rel="noopener">静态和动态绑定</a>）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Base *p = <span class="keyword">new</span> Derived;</span><br><span class="line">p-&gt;func2();				<span class="comment">//调用Derived::func2()</span></span><br><span class="line">p-&gt;func3();				<span class="comment">//调用Base::func3()</span></span><br></pre></td></tr></table></figure>
<p>对于namehiding来说，由于<code>Base::func3</code>不是virtual的，因此编译器会根据对象引用的静态类型而不是对象的实际类型来选择调用哪个函数。(this-&gt;func3)</p>
<p>对于override来说，由于<code>func2</code>是virtual的，因此编译器根据对象的实际类型类型来选择所需的函数。（this-&gt;vfptr-&gt;vtable-&gt;func2）</p>
<p>汇编层面看很清楚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">	p-&gt;func2();</span><br><span class="line">010428FD  mov         eax,dword ptr [p]  </span><br><span class="line">01042900  mov         edx,dword ptr [eax]  </span><br><span class="line">01042902  mov         esi,esp  </span><br><span class="line">01042904  mov         ecx,dword ptr [p]  </span><br><span class="line">01042907  mov         eax,dword ptr [edx+8]  </span><br><span class="line">0104290A  call        eax  </span><br><span class="line">0104290C  cmp         esi,esp  </span><br><span class="line">0104290E  call        __RTC_CheckEsp (010411A9h)  </span><br><span class="line">	p-&gt;func3();</span><br><span class="line">01042913  mov         ecx,dword ptr [p]  </span><br><span class="line">01042916  call        Base::func3 (010414D8h)</span><br></pre></td></tr></table></figure>
<p>所以大致总结如下：</p>
<ul>
<li>在具有继承关系的不同类中，重写（override）仅发生在具有相同函数名且相同参数列表的virtual函数之间。（同函数名、同参数列表、virtual）</li>
<li>在具有继承关系的不同类（具有包含关系的不同作用域）中，具有相同函数名的非ivrtual函数之间（不论参数表是不是一样），都会发生隐藏。（同函数名、非virtual）</li>
<li>在具有继承关系的不同类中，具有相同函数名且参数列表不相同的virtual函数之间，都会发生隐藏。（同函数名、不同参数列表、virtual）</li>
<li>在相同类（作用域）中，函数名相同参数列表不同的函数之间是一种重载关系（overload）</li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/namehiding/">namehiding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/overload/">overload</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/override/">override</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-11-3-关于重载、隐藏、重写的一些思考"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/11/03/2017-11-3-关于重载、隐藏、重写的一些思考/">关于重载、隐藏、重写的一些思考（1）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/11/03/2017-11-3-关于重载、隐藏、重写的一些思考/" class="article-date">
	  <time datetime="2017-11-02T16:00:00.000Z" itemprop="datePublished">十一月 3, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>开始这个问题之前，首先你要已经对于虚函数和虚函数表的概念有了一定得了解。</p>
<p>首先说一下重载（overload）这个概念，这很简单，在C语言里面就有的东西。</p>
<ul>
<li>When two or more different declarations are specified for a single name in the same scope,  that name is said to overloaded.  By extension, two declarations in the same scope that declare the same name but with different types are called overloaded declarations. Only function declarations can be overloaded; object and type declarations cannot be overloaded. </li>
</ul>
<p>通常我们把同一作用域内，可以具有相同函数名，但是参数列表不同的函数，叫做重载函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>好，这so easy！</p>
<p>隐藏（namehiding），这是一个<strong>作用域</strong>的概念，这一点很重要。我们最早知道作用域这个概念，大概是C语言时期。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lf"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以很清晰的知道，<code>double x</code> 是local的，<code>int x</code> 是global的。接着我们考虑继承问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="comment">//重载</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span>)</span></span>;			<span class="comment">//重载</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func4</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>首先，<code>Base::func1</code>是一个纯虚函数，所以我们要在派生类中要去实现它<code>Derived::func1()</code>。我们知道<code>Base::func2</code>这里发生了函数重载，<code>Base::func2()</code>和<code>Base::func2(int)</code>在同一作用域内，函数名相同，但是参数列表不同。同样的<code>Base::func3</code>也发生了重载。</p>
<p>再看<code>Base::func3</code>和<code>Derived::func3</code>，它们在不同作用域内。我们看到这里<code>func3</code>和前面说的<code>x</code>是不是有什么相似的点呢？对，它们的作用域都有一个包含的关系。</p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1fl4m3lx1qfj20a00aijre.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fl4m3lx1qfj20a00aijre.jpg" class="img-fluid"><br></a></p>
<p>注意着张图的画法，要将此和继承的概念区分开，继承的话是Derived包含了Base。好的，我们看看结果是不是和我么想的一样。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Derived d;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line">d.func1();		<span class="comment">//调用Derived::func1()</span></span><br><span class="line">d.func2();		<span class="comment">//调用Base::func2()</span></span><br><span class="line">d.func3();		<span class="comment">//调用Derived::func3()</span></span><br><span class="line">d.func3(x);		<span class="comment">//出错，无法调用Base::func3(int)</span></span><br></pre></td></tr></table></figure>
<p>果然如此，事实也确实如此。所以只要<strong>作用域之间是一种包含关系，不同作用域相同函数名函数之间就会发生隐藏</strong>。</p>
<p>再来看重写（override）的问题，父类和子类函数都是virtual函数并且函数名和参数列表都相同，则它们构成的关系叫做override。</p>
<p>细心的同学一定注意到了上面<code>Derived</code>类里面似乎少了些什么。对，我们没有对于虚函数<code>func2</code>进行<strong>隐藏</strong>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="comment">//重载</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span>)</span></span>;			<span class="comment">//重载</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>;		<span class="comment">//新加的</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">func4</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>此时按照override的定义，可以很清楚地知道<code>Base::func2</code>和<code>Derived::func2</code>构成override关系。</p>
<p>那这个override和namehiding有什么关系吗？它们看上去如此的相似。请看关于重载、隐藏、重写的一些思考（2）。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/namehiding/">namehiding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/overload/">overload</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/override/">override</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-10-28-关于u盘快捷方式病毒的解决方案"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/28/2017-10-28-关于u盘快捷方式病毒的解决方案/">关于u盘快捷方式病毒的解决方案</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/28/2017-10-28-关于u盘快捷方式病毒的解决方案/" class="article-date">
	  <time datetime="2017-10-27T16:00:00.000Z" itemprop="datePublished">十月 28, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/信息安全/">信息安全</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近学校的电脑中了病毒，导致上课时u盘插上电脑后，u盘里面的文件全变成了快捷方式。可能是xxx的一个恶作剧吧，但是挺麻烦的。解决方法非常简单</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">@echo 2017.10.28 by coordinate</span><br><span class="line">@echo +-------------------------------------------------------------+</span><br><span class="line">attrib -s -h *. /S /D</span><br><span class="line">attrib +s +h System~1</span><br><span class="line">attrib +s +h Recycled</span><br><span class="line">attrib +s +h +a ntldr</span><br><span class="line">@echo 完成！</span><br><span class="line">@echo on</span><br></pre></td></tr></table></figure>
<p>将上面的代码copy到一个<code>.txt</code>文件中，然后将这个命名为<code>go.bat</code>，注意后缀名变为<code>bat</code>，也就是一个批处理。接着将<code>go.bat</code>文件copy到u盘中，双击运行即可。</p>
<p>关于上面代码的一些解析</p>
<p><code>ATTRIB [+R | -R][+A | -A ] [+S | -S][+H | -H] [[drive:] [path] filename][/S [/D]]</code></p>
<ul>
<li>+设置属性。  </li>
<li>-清除属性。  </li>
<li>R 只读文件属性。  </li>
<li>A 存档文件属性。  </li>
<li>S 系统文件属性。  </li>
<li>H 隐藏文件属性。  </li>
<li><code>[drive:][path][filename]</code> 指定要处理的文件位置  </li>
<li>/S 处理当前文件夹及其子文件夹中的匹配文件。  </li>
<li>/D 处理文件夹。 </li>
</ul>
<p><code>attrib -s -h *. /S /D</code> 清除当前文件夹及其子文件夹中的文件隐藏文件属性和系统文件属性。</p>
<p><code>attrib +s +h System~1</code> 设置系统还原文件夹隐藏和系统文件属性</p>
<p><code>attrib +s +h Recycled</code> 设置回收站隐藏和系统文件属性</p>
<p><code>attrib +s +h +a ntldr</code> 设置ntldr文件的隐藏、系统和存档属性。ntldr是一个隐藏的，只读的系统文件，位置在系统盘的根目录，用来装载操作系统。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/信息安全/">信息安全</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vbs/">vbs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/病毒/">病毒</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-10-26-使用opencv对图片进行边缘特征提取"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/26/2017-10-26-使用opencv对图片进行边缘特征提取/">使用opencv对图片进行边缘特征提取</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/26/2017-10-26-使用opencv对图片进行边缘特征提取/" class="article-date">
	  <time datetime="2017-10-25T16:00:00.000Z" itemprop="datePublished">十月 26, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/图像处理/">图像处理</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="问题的描述"><a href="#问题的描述" class="headerlink" title="问题的描述"></a>问题的描述</h1><center class="half"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxch0bsj20f40a0aog.jpg" width="300"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxd41xvj20f40a042b.jpg" width="300"><br></center>

<p>我们需要通过一些图像处理的手段，将a图中图像的轮廓提取出来，结果类似于b图。</p>
<h1 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h1><h2 id="使用Laplacian"><a href="#使用Laplacian" class="headerlink" title="使用Laplacian"></a>使用Laplacian</h2><p>看到这个问题，我想到的第一办法就是拉普拉斯算子。ok，沿着这个思路，我通过opencv在windows平台上进行了一些测试。<br>Laplacian 算子的定义:</p>
<ul>
<li>$Laplace(f)=\frac{(∂^2 f)}{(∂x^2 )}+\frac{(∂^2 f)}{(∂y^2 )}$</li>
</ul>
<p>这里求导使用的方法是Sobel算子，关于Sobel算子请看2.3。<br>在opencv中Laplacian的函数原型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CV_EXPORTS_W <span class="keyword">void</span> <span class="title">Laplacian</span><span class="params">( InputArray src, OutputArray dst, <span class="keyword">int</span> ddepth,</span></span></span><br><span class="line"><span class="function"><span class="params">                             <span class="keyword">int</span> ksize = <span class="number">1</span>, <span class="keyword">double</span> scale = <span class="number">1</span>, <span class="keyword">double</span> delta = <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                             <span class="keyword">int</span> borderType = BORDER_DEFAULT )</span></span>;</span><br></pre></td></tr></table></figure>
<p>在opencv源代码中就已经说明了这个函数的使用，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@param src Source image.</span><br><span class="line">@param dst Destination image of the same size and the same number of channels as src .</span><br><span class="line">@param ddepth Desired depth of the destination image.</span><br><span class="line">@param ksize Aperture size used to compute the second-derivative filters. See getDerivKernels for details. The size must be positive and odd.</span><br><span class="line">@param scale Optional scale factor for the computed Laplacian values. By default, no scaling is applied. See getDerivKernels for details.</span><br><span class="line">@param delta Optional delta value that is added to the results prior to storing them in dst .</span><br><span class="line">@param borderType Pixel extrapolation method, see cv::BorderTypes</span><br></pre></td></tr></table></figure>
<p>当ksize=3时，Laplacian()函数的孔径为</p>
<ul>
<li>$\left| \begin{array} (0 &amp; 1 &amp; 0 \1 &amp; -4 &amp; 1  \0 &amp; 1 &amp; 0 \end{array} \right|$</li>
</ul>
<p>注意这里最后一个参数的定义，查看源码发现是一个枚举类型。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> BorderTypes &#123;</span><br><span class="line">    BORDER_CONSTANT    = <span class="number">0</span>, <span class="comment">//!&lt; `iiiiii|abcdefgh|iiiiiii`  with some specified `i`</span></span><br><span class="line">    BORDER_REPLICATE   = <span class="number">1</span>, <span class="comment">//!&lt; `aaaaaa|abcdefgh|hhhhhhh`</span></span><br><span class="line">    BORDER_REFLECT     = <span class="number">2</span>, <span class="comment">//!&lt; `fedcba|abcdefgh|hgfedcb`</span></span><br><span class="line">    BORDER_WRAP        = <span class="number">3</span>, <span class="comment">//!&lt; `cdefgh|abcdefgh|abcdefg`</span></span><br><span class="line">    BORDER_REFLECT_101 = <span class="number">4</span>, <span class="comment">//!&lt; `gfedcb|abcdefgh|gfedcba`</span></span><br><span class="line">    BORDER_TRANSPARENT = <span class="number">5</span>, <span class="comment">//!&lt; `uvwxyz|absdefgh|ijklmno`</span></span><br><span class="line"></span><br><span class="line">    BORDER_REFLECT101  = BORDER_REFLECT_101, <span class="comment">//!&lt; same as BORDER_REFLECT_101</span></span><br><span class="line">    BORDER_DEFAULT     = BORDER_REFLECT_101, <span class="comment">//!&lt; same as BORDER_REFLECT_101</span></span><br><span class="line">    BORDER_ISOLATED    = <span class="number">16</span> <span class="comment">//!&lt; do not look outside of ROI</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>大致含义是这样的</p>
<ul>
<li>BORDER_CONSTANT 需要设置borderValue 指定 ‘ i ‘ 值</li>
<li>BORDER_CONSTANT就是边沿像素用i替换</li>
<li>BORDER_REPLICATE ，复制边界像素</li>
<li>BORDER_REFLECT  ，反射复制边界像素   </li>
<li>BORDER_REFLECT_101，以边界为对称轴反射复制像素</li>
</ul>
<p>这里我选用了BORDER_DEFAULT。</p>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序名称：Laplacian</span></span><br><span class="line"><span class="comment">*开发环境：vs2015+opencv3.3</span></span><br><span class="line"><span class="comment">*2017.10.24 by coordinate</span></span><br><span class="line"><span class="comment">*www.coordinate.wang</span></span><br><span class="line"><span class="comment">*CSDN:coordinate_blog</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">	<span class="comment">//读取图像</span></span><br><span class="line">	cv::Mat img = cv::imread(<span class="string">"avatar.png"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: read image"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//将图像转化为灰度图</span></span><br><span class="line">	cv::Mat img_gray&#123;&#125;;</span><br><span class="line">	cv::cvtColor(img, img_gray, cv::COLOR_RGB2GRAY);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用Laplacian</span></span><br><span class="line">	cv::Mat abs_dst&#123;&#125;;</span><br><span class="line">	<span class="keyword">int</span> kernel_size = <span class="number">3</span>;</span><br><span class="line">	<span class="keyword">int</span> scale = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> delta = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> ddepth = CV_16S;</span><br><span class="line">	cv::Laplacian(img_gray, img, ddepth, kernel_size, scale, delta, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//计算绝对值，并将结果转换成8位</span></span><br><span class="line">	cv::convertScaleAbs(img, abs_dst);</span><br><span class="line">	<span class="comment">// 在窗口中显示avatar  </span></span><br><span class="line">	cv::imshow(<span class="string">"Laplacian"</span>, abs_dst);</span><br><span class="line">	<span class="comment">// 等待按下任意键后窗口关闭       </span></span><br><span class="line">	cv::waitKey(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后的效果图：</p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxdkiqpj20j40dsakz.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxdkiqpj20j40dsakz.jpg" class="img-fluid"><br></a></p>
<p>看上去有些模糊，但是总体的轮廓大致是有了，接下来我觉得可以先对图像进行滤波处理再做拉普拉斯。我这里使用的高斯滤波。</p>
<h2 id="使用Laplacian-高斯滤波"><a href="#使用Laplacian-高斯滤波" class="headerlink" title="使用Laplacian+高斯滤波"></a>使用Laplacian+高斯滤波</h2><p>函数原型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CV_EXPORTS_W <span class="keyword">void</span> <span class="title">GaussianBlur</span><span class="params">( InputArray src, OutputArray dst, Size ksize,</span></span></span><br><span class="line"><span class="function"><span class="params">                                <span class="keyword">double</span> sigmaX, <span class="keyword">double</span> sigmaY = <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                                <span class="keyword">int</span> borderType = BORDER_DEFAULT )</span></span>;</span><br></pre></td></tr></table></figure>
<p>源代码参数说明</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@param src input image; the image can have any number of channels, which are processed</span><br><span class="line">independently, but the depth should be CV_8U, CV_16U, CV_16S, CV_32F <span class="keyword">or</span> CV_64F.</span><br><span class="line">@param dst output image of the same size <span class="keyword">and</span> type as src.</span><br><span class="line">@param ksize Gaussian kernel size. ksize.width <span class="keyword">and</span> ksize.height can differ but they both must be positive <span class="keyword">and</span> odd. Or, they can be zero's <span class="keyword">and</span> then they are computed from sigma.</span><br><span class="line">@param sigmaX Gaussian kernel standard deviation in X direction.</span><br><span class="line">@param sigmaY Gaussian kernel standard deviation in Y direction; <span class="keyword">if</span> sigmaY is zero, it is <span class="built_in">set</span> to be equal to sigmaX, <span class="keyword">if</span> both sigmas are zeros, they are computed from ksize.width <span class="keyword">and</span> ksize.height, respectively (see cv::getGaussianKernel <span class="keyword">for</span> details); to fully control the result regardless of possible future modifications of all <span class="keyword">this</span> semantics, it is recommended to specify all of ksize, sigmaX, <span class="keyword">and</span> sigmaY.</span><br><span class="line">@param borderType pixel extrapolation method, see cv::BorderTypes</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序名称：Laplacian+高斯滤波</span></span><br><span class="line"><span class="comment">*开发环境：vs2015+opencv3.3</span></span><br><span class="line"><span class="comment">*2017.10.24 by coordinate</span></span><br><span class="line"><span class="comment">*www.coordinate.wang</span></span><br><span class="line"><span class="comment">*CSDN:coordinate_blog</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//读取图像</span></span><br><span class="line">	cv::Mat img = cv::imread(<span class="string">"avatar.png"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: read image"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//将图像转化为灰度图</span></span><br><span class="line">	cv::Mat img_gray&#123;&#125;;</span><br><span class="line">	cv::cvtColor(img, img_gray, cv::COLOR_RGB2GRAY);</span><br><span class="line">	<span class="comment">//使用高斯滤波</span></span><br><span class="line">	cv::GaussianBlur(img_gray, img_gray, cv::Size(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//使用Laplacian</span></span><br><span class="line">	cv::Mat abs_dst&#123;&#125;;</span><br><span class="line">	<span class="keyword">int</span> kernel_size = <span class="number">3</span>;</span><br><span class="line">	<span class="keyword">int</span> scale = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> delta = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> ddepth = CV_16S;</span><br><span class="line">	cv::Laplacian(img_gray, img, ddepth, kernel_size, scale, delta, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//计算绝对值，并将结果转换成8位  </span></span><br><span class="line">	cv::convertScaleAbs(img, abs_dst);</span><br><span class="line">	<span class="comment">// 在窗口中显示avatar  </span></span><br><span class="line">	cv::imshow(<span class="string">"Laplacian+高斯滤波"</span>, abs_dst);</span><br><span class="line">	<span class="comment">// 等待按下任意键后窗口关闭    </span></span><br><span class="line">	cv::waitKey(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果是这样的</p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1fkvuxeflnej20j40ds48c.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1fkvuxeflnej20j40ds48c.jpg" class="img-fluid"><br></a></p>
<p>结果上可以看出的是，细节部分损失的很严重，看来要用其他方法。</p>
<h2 id="使用Sobel"><a href="#使用Sobel" class="headerlink" title="使用Sobel"></a>使用Sobel</h2><p>Sobel算法是整像素图像边缘检测中最重要的算子之一，在机器学习、数字媒体、计算机视觉等信息科技领域起着举足轻重的作用。在技术上，它是一个离散的一阶差分算子，用来计算图像亮度函数的一阶梯度之近似值。在图像的任何一点使用此算子，将会产生该点对应的梯度矢量或是其法矢量。</p>
<p>我们假设原始图像叫做A，然后我们分别对x和y方向求导。注意的是在计算机中我们是没有办法求导数的，只可以采用近似的方法。这里是使用了卷积核Gx和Gy</p>
<ul>
<li>$G_x= \left| \begin{array} (-1 &amp; 0 &amp; +1 \-2 &amp; 0 &amp; +2  \-1 &amp; 0 &amp; +1 \end{array} \right | *A$ </li>
<li>$G_y= \left| \begin{array} (-1 &amp; -2 &amp; -1 \0 &amp; 0 &amp; 0  \+1 &amp; +2 &amp; +1 \end{array} \right | *A$ </li>
</ul>
<p>在通过以下公式计算出梯度</p>
<ul>
<li>$G=\sqrt{G_x^2+G_y^2}$</li>
</ul>
<p>可用以下公式计算梯度方向</p>
<ul>
<li>$\theta=\arctan(\frac{G_y}{G_x})$</li>
</ul>
<p>在上面例子中，如果以上的角度Θ等于零，即代表图像该处拥有纵向边缘，左方比右方暗。Sobel算子结合了高斯平滑和分化，结果会更具鲁棒性。</p>
<p>函数原型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CV_EXPORTS_W <span class="keyword">void</span> <span class="title">Sobel</span><span class="params">( InputArray src, OutputArray dst, <span class="keyword">int</span> ddepth,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">int</span> dx, <span class="keyword">int</span> dy, <span class="keyword">int</span> ksize = <span class="number">3</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">double</span> scale = <span class="number">1</span>, <span class="keyword">double</span> delta = <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">int</span> borderType = BORDER_DEFAULT )</span></span>;</span><br></pre></td></tr></table></figure>
<p>源代码中参数定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@param src input image.</span><br><span class="line">@param dst output image of the same size and the same number of channels as src .</span><br><span class="line">@param ddepth output image depth, see @ref filter_depths &quot;combinations&quot;; in the case of</span><br><span class="line">8-bit input images it will result in truncated derivatives.</span><br></pre></td></tr></table></figure>
<p>这里支持的组合有</p>
<ul>
<li>若<code>src.depth() = CV_8U</code>, 取<code>ddepth =-1/CV_16S/CV_32F/CV_64F</code></li>
<li>若<code>src.depth() = CV_16U/CV_16S</code>, 取<code>ddepth =-1/CV_32F/CV_64F</code></li>
<li>若<code>src.depth() = CV_32F</code>, 取<code>ddepth =-1/CV_32F/CV_64F</code></li>
<li>若<code>src.depth() = CV_64F</code>, 取<code>ddepth = -1/CV_64F</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@param dx order of the derivative x.</span><br><span class="line">@param dy order of the derivative y.</span><br><span class="line">@param ksize size of the extended Sobel kernel; it must be 1, 3, 5, or 7.</span><br><span class="line">@param scale optional scale factor for the computed derivative values; by default, no scaling is applied (see cv::getDerivKernels for details).</span><br><span class="line">@param delta optional delta value that is added to the results prior to storing them in dst.</span><br><span class="line">@param borderType pixel extrapolation method, see cv::BorderTypes</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序名称：Sobel</span></span><br><span class="line"><span class="comment">*开发环境：vs2015+opencv3.3</span></span><br><span class="line"><span class="comment">*2017.10.24 by coordinate</span></span><br><span class="line"><span class="comment">*www.coordinate.wang</span></span><br><span class="line"><span class="comment">*CSDN:coordinate_blog</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//读取图像</span></span><br><span class="line">	cv::Mat img = cv::imread(<span class="string">"avatar.png"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: read image"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//将图像转化为灰度图</span></span><br><span class="line">	cv::Mat img_gray&#123;&#125;;</span><br><span class="line">	cv::cvtColor(img, img_gray, cv::COLOR_RGB2GRAY);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用高斯滤波</span></span><br><span class="line">	cv::GaussianBlur(img_gray, img_gray, cv::Size(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//创建 grad_x 和 grad_y 矩阵</span></span><br><span class="line">	cv::Mat grad_x&#123;&#125;, grad_y&#123;&#125;;</span><br><span class="line">	cv::Mat abs_grad_x&#123;&#125;, abs_grad_y&#123;&#125;, dst&#123;&#125;;</span><br><span class="line">	<span class="comment">//求 X方向梯度  </span></span><br><span class="line">	cv::Sobel(img_gray, grad_x, CV_16S, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	cv::convertScaleAbs(grad_x, abs_grad_x);	</span><br><span class="line">	<span class="comment">//求Y方向梯度  </span></span><br><span class="line">	cv::Sobel(img_gray, grad_y, CV_16S, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	convertScaleAbs(grad_y, abs_grad_y);	</span><br><span class="line">	<span class="comment">//合并梯度(近似)  </span></span><br><span class="line">	cv::addWeighted(abs_grad_x, <span class="number">0.5</span>, abs_grad_y, <span class="number">0.5</span>, <span class="number">0</span>, dst);</span><br><span class="line">	cv::imshow(<span class="string">"整体方向Sobel"</span>, dst);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等待按下任意键后窗口关闭    </span></span><br><span class="line">	cv::waitKey(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxezyfxj20j40dsgvs.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkvuxezyfxj20j40dsgvs.jpg" class="img-fluid"><br></a></p>
<p>我觉得使用Sobel虽然没有使用Canny后的图片效果棱角分明，但它更加的自然。</p>
<h2 id="使用canny算子"><a href="#使用canny算子" class="headerlink" title="使用canny算子"></a>使用canny算子</h2><p>Canny边缘检测算子是John F.Canny于 1986 年开发出来的一个多级边缘检测算法。更为重要的是 Canny 创立了边缘检测计算理论（Computational theory ofedge detection）解释这项技术如何工作。</p>
<p>Canny 的目标是找到一个最优的边缘检测算法，最优边缘检测的含义是：</p>
<ul>
<li>好的检测- 算法能够尽可能多地标识出图像中的实际边缘。</li>
<li>好的定位- 标识出的边缘要尽可能与实际图像中的实际边缘尽可能接近。</li>
<li>最小响应- 图像中的边缘只能标识一次，并且可能存在的图像噪声不应标识为边缘。</li>
</ul>
<p>主要步骤</p>
<ul>
<li>消除噪声-使用高斯滤波</li>
<li>计算梯度的幅值和方向-使用Sobel算子</li>
<li>对梯度幅值进行非极大值抑制</li>
<li>用双阈值算法检测和连接边缘</li>
</ul>
<p>函数原型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CV_EXPORTS_W <span class="keyword">void</span> <span class="title">Canny</span><span class="params">( InputArray image, OutputArray edges,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">double</span> threshold1, <span class="keyword">double</span> threshold2,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="keyword">int</span> apertureSize = <span class="number">3</span>, <span class="keyword">bool</span> L2gradient = <span class="literal">false</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<p>源代码参数说明</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@param image <span class="number">8</span>-bit input image.</span><br><span class="line">@param edges output edge <span class="built_in">map</span>; single channels <span class="number">8</span>-bit image, which has the same size as image .</span><br><span class="line">@param threshold1 first threshold <span class="keyword">for</span> the hysteresis procedure.</span><br><span class="line">@param threshold2 second threshold <span class="keyword">for</span> the hysteresis procedure.</span><br><span class="line">@param apertureSize aperture size <span class="keyword">for</span> the Sobel <span class="keyword">operator</span>.</span><br><span class="line">@param L2gradient a flag, indicating whether a more accurate</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序名称：Canny</span></span><br><span class="line"><span class="comment">*开发环境：vs2015+opencv3.3</span></span><br><span class="line"><span class="comment">*2017.10.24 by coordinate</span></span><br><span class="line"><span class="comment">*www.coordinate.wang</span></span><br><span class="line"><span class="comment">*CSDN:coordinate_blog</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//读取图像</span></span><br><span class="line">	cv::Mat img = cv::imread(<span class="string">"avatar.png"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: read image"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//将图像转化为灰度图</span></span><br><span class="line">	cv::Mat img_gray&#123;&#125;;</span><br><span class="line">	cv::cvtColor(img, img_gray, cv::COLOR_RGB2GRAY);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用高斯滤波</span></span><br><span class="line">	cv::GaussianBlur(img_gray, img_gray, cv::Size(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//使用canny算子</span></span><br><span class="line">	<span class="keyword">double</span> threshold1 = <span class="number">120.0</span>;</span><br><span class="line">	<span class="keyword">double</span> threshold2 = <span class="number">55.0</span>;</span><br><span class="line">	<span class="keyword">int</span> apertureSize = <span class="number">3</span>;</span><br><span class="line">	cv::Canny(img_gray, img_gray, threshold1, threshold2, apertureSize);</span><br><span class="line">	<span class="comment">// 在窗口中显示avatar  </span></span><br><span class="line">	cv::imshow(<span class="string">"Canny"</span>, img_gray);</span><br><span class="line">	<span class="comment">// 等待按下任意键后窗口关闭    </span></span><br><span class="line">	cv::waitKey(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参数threshold1主要调节的是外轮廓，参数threshold2主要调节的是内轮廓，我这里经过多次测试后选择这个参数<strong>threshold1=120 threshold2=55</strong>，最后的结果是</p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkvuxffqauj20j40dsaf6.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkvuxffqauj20j40dsaf6.jpg" class="img-fluid"><br></a></p>
<p>效果比Laplacian好太多了。</p>
<h2 id="Scharr滤波器"><a href="#Scharr滤波器" class="headerlink" title="Scharr滤波器"></a>Scharr滤波器</h2><p>Scharr与之前的Sobel类似，只是他们的卷积核不同。它的卷积核分别是</p>
<ul>
<li>$G_x= \left| \begin{array} (-3 &amp; 0 &amp; +3 \-10 &amp; 0 &amp; +10  \-3 &amp; 0 &amp; +3 \end{array} \right | *A$ </li>
<li>$G_y= \left| \begin{array} (-3 &amp; -10 &amp; -3 \0 &amp; 0 &amp; 0  \+3 &amp; +10 &amp; +3 \end{array} \right | *A$ </li>
</ul>
<p>其实我们可以很快的知道，这两者算法的效率是一样的。但是这个卷积核得到的结果比Sobel更精确。</p>
<p>函数原型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CV_EXPORTS_W <span class="keyword">void</span> <span class="title">Scharr</span><span class="params">( InputArray src, OutputArray dst, <span class="keyword">int</span> ddepth,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> dx, <span class="keyword">int</span> dy, <span class="keyword">double</span> scale = <span class="number">1</span>, <span class="keyword">double</span> delta = <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> borderType = BORDER_DEFAULT )</span></span>;</span><br></pre></td></tr></table></figure>
<p>源代码中参数的定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@param src input image.</span><br><span class="line">@param dst output image of the same size and the same number of channels as src.</span><br><span class="line">@param ddepth output image depth, see @ref filter_depths &quot;combinations&quot;</span><br><span class="line">@param dx order of the derivative x.</span><br><span class="line">@param dy order of the derivative y.</span><br><span class="line">@param scale optional scale factor for the computed derivative values; by default, no scaling is applied (see getDerivKernels for details).</span><br><span class="line">@param delta optional delta value that is added to the results prior to storing them in dst.</span><br><span class="line">@param borderType pixel extrapolation method, see cv::BorderTypes</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序名称：scharr</span></span><br><span class="line"><span class="comment">*开发环境：vs2015+opencv3.3</span></span><br><span class="line"><span class="comment">*2017.10.24 by coordinate</span></span><br><span class="line"><span class="comment">*www.coordinate.wang</span></span><br><span class="line"><span class="comment">*CSDN:coordinate_blog</span></span><br><span class="line"><span class="comment">*********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//读取图像</span></span><br><span class="line">	cv::Mat img = cv::imread(<span class="string">"avatar.png"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: read image"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//将图像转化为灰度图</span></span><br><span class="line">	cv::Mat img_gray&#123;&#125;;</span><br><span class="line">	cv::cvtColor(img, img_gray, cv::COLOR_RGB2GRAY);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用高斯滤波</span></span><br><span class="line">	cv::GaussianBlur(img_gray, img_gray, cv::Size(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	<span class="comment">//创建 grad_x 和 grad_y 矩阵</span></span><br><span class="line">	cv::Mat grad_x&#123;&#125;, grad_y&#123;&#125;;</span><br><span class="line">	cv::Mat abs_grad_x&#123;&#125;, abs_grad_y&#123;&#125;, dst&#123;&#125;;</span><br><span class="line">	<span class="comment">//求 X方向梯度  </span></span><br><span class="line">	cv::Scharr(img_gray, grad_x, CV_16S, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	cv::convertScaleAbs(grad_x, abs_grad_x);</span><br><span class="line">	<span class="comment">//求Y方向梯度  </span></span><br><span class="line">	cv::Scharr(img_gray, grad_y, CV_16S, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, cv::BORDER_DEFAULT);</span><br><span class="line">	cv::convertScaleAbs(grad_y, abs_grad_y);</span><br><span class="line">	<span class="comment">//合并梯度(近似)  </span></span><br><span class="line">	cv::addWeighted(abs_grad_x, <span class="number">0.5</span>, abs_grad_y, <span class="number">0.5</span>, <span class="number">0</span>, dst);</span><br><span class="line">	<span class="comment">//显示效果图  </span></span><br><span class="line">	imshow(<span class="string">"合并梯度后Scharr"</span>, dst);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等待按下任意键后窗口关闭    </span></span><br><span class="line">	cv::waitKey(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后的结果为</p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1fkvuxfvookj20j40dsk3f.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1fkvuxfvookj20j40dsk3f.jpg" class="img-fluid"><br></a></p>
<p>相较于之前的Sobel，这次的图像在细节上面更加的好了。</p>
<h2 id="最后的整合"><a href="#最后的整合" class="headerlink" title="最后的整合"></a>最后的整合</h2><p>最后我把我做的工作，结合到了我开发的一个小程序中。</p>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkvuxg94mej20zm0m70u8.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkvuxg94mej20zm0m70u8.jpg" class="img-fluid"><br></a></p>
<p>小程序的教程在整理中^_^!!!</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/图像处理/">图像处理</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/opencv/">opencv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/qt/">qt</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-10-21-QT5.9.1与opencv3.3读取图片"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/10/21/2017-10-21-QT5.9.1与opencv3.3读取图片/">QT5.9.1与opencv3.3读取图片</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/10/21/2017-10-21-QT5.9.1与opencv3.3读取图片/" class="article-date">
	  <time datetime="2017-10-20T16:00:00.000Z" itemprop="datePublished">十月 21, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/QT/">QT</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>首先我们要新建一个项目，选择Qt Widgets Application</p>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkppk07so9j20oi0fjwez.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkppk07so9j20oi0fjwez.jpg" class="img-fluid"><br></a></p>
<p>一直点击下一步，直到出现下面这个窗口（项目名称自己填写一个）</p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppk0lrthj20p20d9glq.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppk0lrthj20p20d9glq.jpg" class="img-fluid"><br></a></p>
<p>注意这里的基类我们要选择QMianWindow，因为我们要做一个带有菜单的界面。接着点击下一步完成即可。</p>
<p>点击pro文件，添加opencv的路径，以及我们所需的相关库文件，例如</p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppk1kzddj206k05egll.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppk1kzddj206k05egll.jpg" class="img-fluid"><br></a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INCLUDEPATH +=  F:\opencv\opencv3\QT_opencv\include\opencv \</span><br><span class="line">                F:\opencv\opencv3\QT_opencv\include\opencv2 \</span><br><span class="line">                F:\opencv\opencv3\QT_opencv\include</span><br><span class="line">LIBS += -L F:\opencv\opencv3\QT_opencv\x86\mingw\lib\libopencv_*.a</span><br></pre></td></tr></table></figure>
<p>按照我这篇<a href="http://blog.csdn.net/qq_17550379/article/details/78296057" target="_blank" rel="noopener">文章</a>里面讲的方法，将相应的dll文件copy到工程目录中去（如果不这样做会出现crashed问题）。</p>
<p>然后双击<code>mianwindow.ui</code>，接下来我们设计图形界面。</p>
<p>双击<code>在这里输入</code>，我这里输入<code>文件(F)</code>，然后点击我们创建好的<code>文件(F)</code> 我们接着在创建一个<code>a</code>，因为我们这里无法输入汉字，所以先输入一个字母代替。</p>
<p>接着选中这个<code>a</code>，在下面的菜单栏中修改名称为<code>actionOpenFile</code>，双击快捷键出现编辑动作选项，我们选中<code>shortcut</code>然后按下<code>ctrl+f</code>组合键，即可创建快捷键。如图</p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppwqxx4hj20at08lmx3.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659ly1fkppwqxx4hj20at08lmx3.jpg" class="img-fluid"><br></a></p>
<p>然后右击，选择<code>转到槽</code>，QAction选择triggered，生成对应的槽函数。再回到ui界面。</p>
<p>从左边的菜单栏中的Display Widgets中选择出label，将它拖到主界面中。</p>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkppzmyxvdj20hg0dbglj.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fkppzmyxvdj20hg0dbglj.jpg" class="img-fluid"><br></a></p>
<p>双击label，删除里面的文字信息。调整label的大小，使它和整个界面大小一致。最后的界面是这样的</p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkppjzr0b3j21f60u041o.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkppjzr0b3j21f60u041o.jpg" class="img-fluid"><br></a></p>
<p>ui界面就搞定了，接下来解决槽函数的编写。</p>
<p>我们这里使用QImage存储图片对象，而opencv中使用的是Mat数据结构，所以我们要做一些转换操作。使用cvtColor函数将Mat的BGR顺序转换为QImage的RGB顺序。</p>
<p>要添加如下头文件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QImage&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFile&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>槽函数为</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> MainWindow::on_actionOpenFile_triggered()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//打开文件选择框</span></span><br><span class="line">    QString path = QFileDialog::getOpenFileName(<span class="keyword">this</span>, tr(<span class="string">"open"</span>), tr(<span class="string">"../"</span>));</span><br><span class="line">    <span class="keyword">if</span>(!path.isEmpty())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//读取一幅图片，这里我们要将QString转换为String使用toStdString函数</span></span><br><span class="line">        cv::Mat image = cv::imread(path.toStdString());</span><br><span class="line">        <span class="keyword">if</span>(!image.data)</span><br><span class="line">        &#123;</span><br><span class="line">            QMessageBox::warning(<span class="keyword">this</span>, tr(<span class="string">"警告"</span>),tr(<span class="string">"图片打开失败"</span>));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//改变彩色通道顺序</span></span><br><span class="line">            cv::cvtColor(image, image, CV_RGB2BGR);</span><br><span class="line">            <span class="comment">//初始化QImage对象</span></span><br><span class="line">            QImage img = QImage((<span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="keyword">char</span>*)(image.data), image.cols, image.rows, QImage::Format_RGB888);</span><br><span class="line">            <span class="comment">//显示在label中</span></span><br><span class="line">            ui-&gt;label-&gt;setPixmap(QPixmap::fromImage(img));</span><br><span class="line">            <span class="comment">//改变label的大小用于自适应图像大小</span></span><br><span class="line">            ui-&gt;label-&gt;resize(ui-&gt;label-&gt;pixmap()-&gt;size());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::warning(<span class="keyword">this</span>, tr(<span class="string">"警告"</span>),tr(<span class="string">"请选择文件"</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后的效果图</p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkpv4q9f2gj20hj0ef3ys.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1fkpv4q9f2gj20hj0ef3ys.jpg" class="img-fluid"><br></a></p>
<p>至此我们实现了一个简单的图片读取功能^_^，下一讲我会对这个功能进行一些优化。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/QT/">QT</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/opencv/">opencv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/qt/">qt</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/4/">下一页</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" 搜索…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="搜索">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">联系我们</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/luliyucoordinate" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>最新文章</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/20/2017-12-20-YOLOv2代码分析（四）/">YOLOv2代码分析（四）</a></h6>
              <span>十二月 20, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/19/2017-12-19-YOLOv2代码分析（三）/">YOLOv2代码分析（三）</a></h6>
              <span>十二月 19, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/17/2017-12-17-YOLOv2代码分析（二）/">YOLOv2代码分析（二）</a></h6>
              <span>十二月 17, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/16/2017-12-16-YOLOv2代码分析（一）/">YOLOv2代码分析（一）</a></h6>
              <span>十二月 16, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/15/2017-12-15-目标检测中的IOU计算问题/">目标检测中的IOU计算问题</a></h6>
              <span>十二月 15, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/13/2017-12-13-tf.identity的作用/">tf.identity的作用</a></h6>
              <span>十二月 13, 2017</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/QT/">QT</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/asp/">asp</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cpp/">cpp</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/index/">index</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/toy/">toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息安全/">信息安全</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/图像处理/">图像处理</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机系统原理/">计算机系统原理</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/1080ti/">1080ti</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Aggregate/">Aggregate</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dell/">Dell</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eassy/">Eassy</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eval/">Eval</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Execute/">Execute</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ExecuteGlobal/">ExecuteGlobal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fibonacci/">Fibonacci</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOU/">IOU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kolakoski/">Kolakoski</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MNIST/">MNIST</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PIL/">PIL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/POD/">POD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/QT/">QT</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YOLO/">YOLO</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/acm/">acm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/advance/">advance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/array/">array</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp/">asp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto&</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto&&</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binding/">binding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c#</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cin/">cin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/constexpr/">constexpr</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/">cpp</a><span class="tag-list-count">90</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp标准库/">cpp标准库</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp第二版/">cpp第二版</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cuda/">cuda</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cudnn/">cudnn</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/darknet/">darknet</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dd/">dd</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/">default</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/downcasting/">downcasting</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/">error</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/estimator/">estimator</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/forward/">forward</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glvalue/">glvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hook/">hook</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/identity/">identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lvalue/">lvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mismatch/">mismatch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/move/">move</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/namehiding/">namehiding</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/next/">next</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notes/">notes</a><span class="tag-list-count">29</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/numpy/">numpy</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/office/">office</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oj/">oj</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opencv/">opencv</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/">oracle</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/overload/">overload</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/override/">override</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/piecewise-construct/">piecewise_construct</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/">pip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pipe/">pipe</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/process/">process</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prvalue/">prvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pytesseract/">pytesseract</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt/">qt</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quit/">quit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/re/">re</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rvalue/">rvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/signal/">signal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql注入/">sql注入</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tensorflow/">tensorflow</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/">thread</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/threading/">threading</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie树/">trie树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uninstall/">uninstall</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unordered-multimap/">unordered_multimap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upcasting/">upcasting</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vbs/">vbs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vector/">vector</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vfptr/">vfptr</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/">vmware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wait/">wait</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlvalue/">xlvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/人工智能/">人工智能</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/仿函数/">仿函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存模型/">内存模型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/决策树算法/">决策树算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分配器/">分配器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原理/">原理</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/反斜杠/">反斜杠</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/回文字符串/">回文字符串</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多态/">多态</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字典树/">字典树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/引用折叠/">引用折叠</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排列组合/">排列组合</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/木马/">木马</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习/">机器学习</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模式识别/">模式识别</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深度学习/">深度学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/漏洞/">漏洞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/病毒/">病毒</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔试/">笔试</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/缓冲区溢出/">缓冲区溢出</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机网络/">计算机网络</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪吃蛇/">贪吃蛇</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪心算法/">贪心算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/迭代器/">迭代器</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/适配器/">适配器</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/1080ti/" style="font-size: 10.83px;">1080ti</a> <a href="/tags/Aggregate/" style="font-size: 10px;">Aggregate</a> <a href="/tags/Dell/" style="font-size: 11.67px;">Dell</a> <a href="/tags/Eassy/" style="font-size: 11.67px;">Eassy</a> <a href="/tags/Eval/" style="font-size: 10px;">Eval</a> <a href="/tags/Execute/" style="font-size: 10px;">Execute</a> <a href="/tags/ExecuteGlobal/" style="font-size: 10px;">ExecuteGlobal</a> <a href="/tags/Fibonacci/" style="font-size: 10px;">Fibonacci</a> <a href="/tags/IOU/" style="font-size: 10px;">IOU</a> <a href="/tags/Kolakoski/" style="font-size: 10px;">Kolakoski</a> <a href="/tags/MNIST/" style="font-size: 10.83px;">MNIST</a> <a href="/tags/MySQL/" style="font-size: 10.83px;">MySQL</a> <a href="/tags/PIL/" style="font-size: 10px;">PIL</a> <a href="/tags/POD/" style="font-size: 10px;">POD</a> <a href="/tags/QT/" style="font-size: 11.67px;">QT</a> <a href="/tags/Ubuntu/" style="font-size: 11.67px;">Ubuntu</a> <a href="/tags/YOLO/" style="font-size: 12.5px;">YOLO</a> <a href="/tags/acm/" style="font-size: 10px;">acm</a> <a href="/tags/advance/" style="font-size: 10px;">advance</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/array/" style="font-size: 10px;">array</a> <a href="/tags/asp/" style="font-size: 10px;">asp</a> <a href="/tags/auto/" style="font-size: 10.83px;">auto</a> <a href="/tags/auto/" style="font-size: 10px;">auto&</a> <a href="/tags/auto/" style="font-size: 10px;">auto&&</a> <a href="/tags/binding/" style="font-size: 10px;">binding</a> <a href="/tags/c/" style="font-size: 17.5px;">c</a> <a href="/tags/c/" style="font-size: 10px;">c#</a> <a href="/tags/cin/" style="font-size: 10px;">cin</a> <a href="/tags/constexpr/" style="font-size: 10px;">constexpr</a> <a href="/tags/cpp/" style="font-size: 20px;">cpp</a> <a href="/tags/cpp标准库/" style="font-size: 17.5px;">cpp标准库</a> <a href="/tags/cpp第二版/" style="font-size: 11.67px;">cpp第二版</a> <a href="/tags/cuda/" style="font-size: 10.83px;">cuda</a> <a href="/tags/cudnn/" style="font-size: 10.83px;">cudnn</a> <a href="/tags/darknet/" style="font-size: 12.5px;">darknet</a> <a href="/tags/dd/" style="font-size: 10px;">dd</a> <a href="/tags/default/" style="font-size: 10px;">default</a> <a href="/tags/downcasting/" style="font-size: 10px;">downcasting</a> <a href="/tags/error/" style="font-size: 11.67px;">error</a> <a href="/tags/estimator/" style="font-size: 11.67px;">estimator</a> <a href="/tags/forward/" style="font-size: 10px;">forward</a> <a href="/tags/game/" style="font-size: 10px;">game</a> <a href="/tags/glvalue/" style="font-size: 10px;">glvalue</a> <a href="/tags/hook/" style="font-size: 10px;">hook</a> <a href="/tags/identity/" style="font-size: 10px;">identity</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/lvalue/" style="font-size: 10px;">lvalue</a> <a href="/tags/map/" style="font-size: 10px;">map</a> <a href="/tags/mismatch/" style="font-size: 10px;">mismatch</a> <a href="/tags/move/" style="font-size: 10px;">move</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/namehiding/" style="font-size: 10.83px;">namehiding</a> <a href="/tags/network/" style="font-size: 12.5px;">network</a> <a href="/tags/next/" style="font-size: 10px;">next</a> <a href="/tags/notes/" style="font-size: 19.17px;">notes</a> <a href="/tags/numpy/" style="font-size: 12.5px;">numpy</a> <a href="/tags/office/" style="font-size: 10.83px;">office</a> <a href="/tags/oj/" style="font-size: 10px;">oj</a> <a href="/tags/opencv/" style="font-size: 14.17px;">opencv</a> <a href="/tags/oracle/" style="font-size: 10.83px;">oracle</a> <a href="/tags/overload/" style="font-size: 10.83px;">overload</a> <a href="/tags/override/" style="font-size: 10.83px;">override</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/piecewise-construct/" style="font-size: 10px;">piecewise_construct</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/pipe/" style="font-size: 10.83px;">pipe</a> <a href="/tags/process/" style="font-size: 10px;">process</a> <a href="/tags/prvalue/" style="font-size: 10px;">prvalue</a> <a href="/tags/pytesseract/" style="font-size: 10px;">pytesseract</a> <a href="/tags/python/" style="font-size: 18.33px;">python</a> <a href="/tags/qt/" style="font-size: 13.33px;">qt</a> <a href="/tags/quit/" style="font-size: 10px;">quit</a> <a href="/tags/re/" style="font-size: 11.67px;">re</a> <a href="/tags/requests/" style="font-size: 10.83px;">requests</a> <a href="/tags/rvalue/" style="font-size: 10px;">rvalue</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/signal/" style="font-size: 10.83px;">signal</a> <a href="/tags/sql/" style="font-size: 10.83px;">sql</a> <a href="/tags/sql注入/" style="font-size: 10px;">sql注入</a> <a href="/tags/stl/" style="font-size: 16.67px;">stl</a> <a href="/tags/tensorflow/" style="font-size: 15px;">tensorflow</a> <a href="/tags/thread/" style="font-size: 10.83px;">thread</a> <a href="/tags/threading/" style="font-size: 10px;">threading</a> <a href="/tags/trie树/" style="font-size: 10px;">trie树</a> <a href="/tags/uninstall/" style="font-size: 10.83px;">uninstall</a> <a href="/tags/unordered-multimap/" style="font-size: 10px;">unordered_multimap</a> <a href="/tags/upcasting/" style="font-size: 10px;">upcasting</a> <a href="/tags/vbs/" style="font-size: 10px;">vbs</a> <a href="/tags/vector/" style="font-size: 10px;">vector</a> <a href="/tags/vfptr/" style="font-size: 10px;">vfptr</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/wait/" style="font-size: 10px;">wait</a> <a href="/tags/xlvalue/" style="font-size: 10px;">xlvalue</a> <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a> <a href="/tags/仿函数/" style="font-size: 10px;">仿函数</a> <a href="/tags/内存模型/" style="font-size: 10px;">内存模型</a> <a href="/tags/决策树算法/" style="font-size: 10px;">决策树算法</a> <a href="/tags/分配器/" style="font-size: 10px;">分配器</a> <a href="/tags/原理/" style="font-size: 17.5px;">原理</a> <a href="/tags/反斜杠/" style="font-size: 10px;">反斜杠</a> <a href="/tags/回文字符串/" style="font-size: 10px;">回文字符串</a> <a href="/tags/多态/" style="font-size: 10px;">多态</a> <a href="/tags/字典树/" style="font-size: 10px;">字典树</a> <a href="/tags/引用折叠/" style="font-size: 10px;">引用折叠</a> <a href="/tags/排列组合/" style="font-size: 10px;">排列组合</a> <a href="/tags/木马/" style="font-size: 10px;">木马</a> <a href="/tags/机器学习/" style="font-size: 10.83px;">机器学习</a> <a href="/tags/模式识别/" style="font-size: 10px;">模式识别</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/深度学习/" style="font-size: 10px;">深度学习</a> <a href="/tags/漏洞/" style="font-size: 10px;">漏洞</a> <a href="/tags/病毒/" style="font-size: 10px;">病毒</a> <a href="/tags/笔试/" style="font-size: 11.67px;">笔试</a> <a href="/tags/算法/" style="font-size: 13.33px;">算法</a> <a href="/tags/缓冲区溢出/" style="font-size: 10px;">缓冲区溢出</a> <a href="/tags/计算机网络/" style="font-size: 10.83px;">计算机网络</a> <a href="/tags/贪吃蛇/" style="font-size: 10px;">贪吃蛇</a> <a href="/tags/贪心算法/" style="font-size: 10px;">贪心算法</a> <a href="/tags/转载/" style="font-size: 15.83px;">转载</a> <a href="/tags/迭代器/" style="font-size: 12.5px;">迭代器</a> <a href="/tags/适配器/" style="font-size: 10px;">适配器</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 coordinate All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
      var headerblur = document.getElementById("header-blur");
      headerblur.style.minHeight = window.getComputedStyle(document.getElementById("allheader"), null).height;
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
